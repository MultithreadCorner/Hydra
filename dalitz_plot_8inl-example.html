<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hydra: dalitz_plot.inl</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_Hydra2.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hydra
   &#160;<span id="projectnumber">4.0.1</span>
   </div>
   <div id="projectbrief">A header-only templated C++ framework to perform data analysis on massively parallel platforms.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dalitz_plot_8inl-example.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dalitz_plot.inl</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*----------------------------------------------------------------------------</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Copyright (C) 2016 - 2020 Antonio Augusto Alves Junior</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   This file is part of Hydra Data Analysis Framework.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Hydra is free software: you can redistribute it and/or modify</span></div><div class="line"><span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><span class="comment"> *   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><span class="comment"> *   (at your option) any later version.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Hydra is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><span class="comment"> *   along with Hydra.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *---------------------------------------------------------------------------*/</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * dalitz_plot.inl</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *  Created on: 29/12/2017</span></div><div class="line"><span class="comment"> *      Author: Antonio Augusto Alves Junior</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#ifndef DALITZ_PLOT_INL_</span></div><div class="line"><span class="preprocessor">#define DALITZ_PLOT_INL_</span></div><div class="line"></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * \example dalitz_plot.inl</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;random&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//command line</span></div><div class="line"><span class="preprocessor">#include &lt;tclap/CmdLine.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//hydra</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="host_2System_8h.html">hydra/host/System.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="device_2System_8h.html">hydra/device/System.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Function_8h.html">hydra/Function.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Lambda_8h.html">hydra/Lambda.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="FunctorArithmetic_8h.html">hydra/FunctorArithmetic.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Placeholders_8h.html">hydra/Placeholders.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Complex_8h.html">hydra/Complex.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Tuple_8h.html">hydra/Tuple.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Range_8h.html">hydra/Range.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Distance_8h.html">hydra/Distance.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="LogLikelihoodFCN_8h.html">hydra/LogLikelihoodFCN.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Parameter_8h.html">hydra/Parameter.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="UserParameters_8h.html">hydra/UserParameters.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Pdf_8h.html">hydra/Pdf.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="AddPdf_8h.html">hydra/AddPdf.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Vector4R_8h.html">hydra/Vector4R.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PhaseSpace_8h.html">hydra/PhaseSpace.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PhaseSpaceIntegrator_8h.html">hydra/PhaseSpaceIntegrator.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Decays_8h.html">hydra/Decays.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="DenseHistogram_8h.html">hydra/DenseHistogram.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SparseHistogram_8h.html">hydra/SparseHistogram.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="BreitWignerLineShape_8h.html">hydra/functions/BreitWignerLineShape.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="CosHelicityAngle_8h.html">hydra/functions/CosHelicityAngle.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ZemachFunctions_8h.html">hydra/functions/ZemachFunctions.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SeedRNG_8h.html">hydra/SeedRNG.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//Minuit2</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/FunctionMinimum.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnUserParameterState.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnPrint.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnMigrad.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnMinimize.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">/*-------------------------------------</span></div><div class="line"><span class="comment"> * Include classes from ROOT to fill</span></div><div class="line"><span class="comment"> * and draw histograms and plots.</span></div><div class="line"><span class="comment"> *-------------------------------------</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#ifdef _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;TROOT.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH1D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH2D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH3D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TApplication.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TCanvas.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TLegend.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TLegendEntry.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif //_ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"><a name="a0"></a><a class="code" href="dalitz__plot_8inl.html#a603ef8439f05f1c254502c69243947eb">declarg</a>(Dplus, hydra::Vector4R)</div><div class="line"><a class="code" href="dalitz__plot_8inl.html#a603ef8439f05f1c254502c69243947eb">declarg</a>(PionA, hydra::Vector4R)</div><div class="line"><a class="code" href="dalitz__plot_8inl.html#a603ef8439f05f1c254502c69243947eb">declarg</a>(PionB, hydra::Vector4R)</div><div class="line"><a class="code" href="dalitz__plot_8inl.html#a603ef8439f05f1c254502c69243947eb">declarg</a>(Kaon , hydra::Vector4R)</div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceROOT_1_1Minuit2.html">ROOT::Minuit2</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacehydra_1_1placeholders.html">hydra::placeholders</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacehydra_1_1arguments.html">hydra::arguments</a>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* GPUs have a formal parameter space of maximum 4kB</span></div><div class="line"><span class="comment"> * So, to save stack-size when dispatching to GPUs</span></div><div class="line"><span class="comment"> * each resonant contribution will be evaluated</span></div><div class="line"><span class="comment"> * in the channels 1 [ D+ -&gt;  K- pi+ pi+ ] and 3 [ D+ -&gt;  K- pi+ pi+ ]</span></div><div class="line"><span class="comment"> * at same time.              ^--^                        ^------^</span></div><div class="line"><span class="comment"> * The model in this example tries to mimic one of the models</span></div><div class="line"><span class="comment"> * in the reference</span></div><div class="line"><span class="comment"> * https://arxiv.org/pdf/0802.4214.pdf</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="comment">//compute the Wave parity in compile time</span></div><div class="line"><span class="keyword">template</span>&lt;hydra::Wave L, <span class="keywordtype">bool</span> Flag=(L%2)&gt;</div><div class="line"><span class="keyword">struct </span><a name="_a1"></a><a class="code" href="dalitz__plot_8inl.html#structparity">parity</a>;</div><div class="line"></div><div class="line"><span class="comment">//positive</span></div><div class="line"><span class="keyword">template</span>&lt;hydra::Wave L&gt;</div><div class="line"><span class="keyword">struct </span><a class="code" href="dalitz__plot_8inl.html#structparity">parity</a>&lt;L, false&gt;: std::integral_constant&lt;int,1&gt;{};</div><div class="line"></div><div class="line"><span class="comment">//negative</span></div><div class="line"><span class="keyword">template</span>&lt;hydra::Wave L&gt;</div><div class="line"><span class="keyword">struct </span><a class="code" href="dalitz__plot_8inl.html#structparity">parity</a>&lt;L, true&gt;:  std::integral_constant&lt;int,-1&gt;{};</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Class Resonance represents a resonant contribution in the</span></div><div class="line"><span class="comment"> * isobar model. The line-shape is represented as a relativistic Breit-Wigner</span></div><div class="line"><span class="comment"> * angular distribution is represented using Zemach formalism.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">template</span>&lt;hydra::Wave L, <span class="keyword">typename</span> Signature=hydra::complex&lt;<span class="keywordtype">double</span>&gt;(Kaon,PionA,PionB)&gt;</div><div class="line"><span class="keyword">class </span><a name="_a2"></a><a class="code" href="classResonance.html">Resonance</a>: <span class="keyword">public</span> <a name="_a3"></a><a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;Resonance&lt;L&gt;, Signature, 4&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">typedef</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;Resonance&lt;L&gt;</a>, Signature, 4&gt; super_type;</div><div class="line"></div><div class="line">    <span class="keyword">using</span> super_type::_par;</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>() = <span class="keyword">delete</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>(<a name="_a4"></a><a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_re, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_im,</div><div class="line">              <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; <a name="a5"></a><a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; <a name="a6"></a><a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>,</div><div class="line">              <span class="keywordtype">double</span> mother_mass, <span class="keywordtype">double</span> daugther1_mass, <span class="keywordtype">double</span> daugther2_mass, <span class="keywordtype">double</span> daugther3_mass, <span class="keywordtype">double</span> radi):</div><div class="line">            super_type({c_re, c_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>}),</div><div class="line">            fLineShape(<a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, mother_mass, daugther1_mass, daugther2_mass, daugther3_mass, radi)</div><div class="line">    {}</div><div class="line"></div><div class="line"></div><div class="line">    <a name="a7"></a><a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>( <a class="code" href="classResonance.html">Resonance&lt;L&gt;</a> <span class="keyword">const</span>&amp; other):</div><div class="line">    super_type(other),</div><div class="line">    fLineShape(other.GetLineShape())</div><div class="line">    {}</div><div class="line"></div><div class="line">    <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <span class="keyword">inline</span> <a class="code" href="classResonance.html">Resonance&lt;L&gt;</a>&amp;</div><div class="line">    operator=( <a class="code" href="classResonance.html">Resonance&lt;L&gt;</a> <span class="keyword">const</span>&amp; other)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>(<span class="keyword">this</span>==&amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"></div><div class="line">        super_type::operator=(other);</div><div class="line">        fLineShape=other.<a name="a8"></a><a class="code" href="classResonance.html#a2edc9006b706606846d5f14259931561">GetLineShape</a>();</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <span class="keyword">inline</span> <a name="_a9"></a><a class="code" href="group__common__functions.html">hydra::BreitWignerLineShape&lt;L,L,double&gt;</a> <span class="keyword">const</span>&amp;</div><div class="line">    GetLineShape()<span class="keyword"> const </span>{  <span class="keywordflow">return</span> fLineShape; }</div><div class="line"></div><div class="line">    <span class="keywordtype">void</span> Update() final     {</div><div class="line"></div><div class="line">        fLineShape.<a name="a10"></a><a class="code" href="classhydra_1_1detail_1_1Parameters.html#abc8dfeab9029bae35e0c00da71d4d0fa">SetParameter</a>(0, _par[2]);</div><div class="line">        fLineShape.SetParameter(1, _par[3]);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <span class="keyword">inline</span> <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a></div><div class="line">    Evaluate(Kaon kaon, PionA pion1, PionB pion2)<span class="keyword">  const </span>{</div><div class="line"></div><div class="line"></div><div class="line">        hydra::Vector4R mother = kaon + pion1 + pion2;</div><div class="line">        hydra::Vector4R Kpi1   = kaon + pion1;</div><div class="line">        hydra::Vector4R Kpi2   = kaon + pion2;</div><div class="line"></div><div class="line"></div><div class="line">        <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a> contrib_12 = fLineShape((Kpi1).<a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>())*fAngularDist(fCosDecayAngle(mother, Kpi1, kaon));</div><div class="line">        <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a> contrib_13 = fLineShape((Kpi2).<a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>())*fAngularDist(fCosDecayAngle(mother, Kpi2, pion2));</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> r = <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a>(_par[0], _par[1])*(contrib_12 + <span class="keywordtype">double</span>(<a class="code" href="dalitz__plot_8inl.html#structparity">parity&lt;L&gt;::value</a>)*contrib_13 ) ;</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> r;</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line"></div><div class="line">    <span class="keyword">mutable</span> <a class="code" href="group__common__functions.html">hydra::BreitWignerLineShape&lt;L,L,double&gt;</a> fLineShape;</div><div class="line">    <a name="_a11"></a><a class="code" href="classhydra_1_1CosHelicityAngle.html">hydra::CosHelicityAngle</a> fCosDecayAngle;</div><div class="line">    <a name="_a12"></a><a class="code" href="group__common__functions.html">hydra::ZemachFunction&lt;L,double&gt;</a> fAngularDist;</div><div class="line"></div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Non-resonant contribution is a contstant over the phase-space,</span></div><div class="line"><span class="comment"> * carrying only magnitude and phase.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">class </span><a name="_a13"></a><a class="code" href="classNonResonant.html">NonResonant</a>: <span class="keyword">public</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;NonResonant, hydra::complex&lt;double&gt;(Kaon,PionA,PionB), 2&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">typedef</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;NonResonant, hydra::complex&lt;double&gt;</a>(Kaon,PionA,PionB), 2&gt; super_type;</div><div class="line"></div><div class="line">    <span class="keyword">using</span> super_type::_par;</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>() = <span class="keyword">delete</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>(<a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_re, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_im):</div><div class="line">         super_type({c_re, c_im})</div><div class="line">    {}</div><div class="line"></div><div class="line"></div><div class="line">     <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>( <a class="code" href="classNonResonant.html">NonResonant</a> <span class="keyword">const</span>&amp; other):</div><div class="line">    super_type(other)</div><div class="line">    {}</div><div class="line"></div><div class="line">     <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>&amp; operator=( <a class="code" href="classNonResonant.html">NonResonant</a> <span class="keyword">const</span>&amp; other)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>(<span class="keyword">this</span>==&amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"></div><div class="line">        super_type::operator=(other);</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">     <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a>  <span class="keyword">inline</span></div><div class="line">    <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a> Evaluate(Kaon , PionA , PionB )<span class="keyword">  const </span>{</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a>(_par[0], _par[1]);</div><div class="line">    }</div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> *Class Norm: sum up the resonances and</span></div><div class="line"><span class="comment"> *then calculates the norm of the result</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> ...T&gt;</div><div class="line"><span class="keyword">class </span><a name="_a14"></a><a class="code" href="classNorm.html">Norm</a>: <span class="keyword">public</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;Norm&lt;T...&gt;, double(T...),0&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">typedef</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;<a class="code" href="classNorm.html">Norm</a>&lt;T...&gt;, <a name="_a15"></a><a class="code" href="namespace_3globalScope_4.html#classdouble">double</a>(T...),0&gt; super_type;</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <a class="code" href="classNorm.html">Norm</a>()=<span class="keywordflow">default</span>;</div><div class="line"></div><div class="line">     <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <a class="code" href="classNorm.html">Norm</a>( <a class="code" href="classNorm.html">Norm&lt;T...&gt;</a> <span class="keyword">const</span>&amp; other):</div><div class="line">        super_type(other)</div><div class="line">    {}</div><div class="line"></div><div class="line">     <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <a class="code" href="classNorm.html">Norm</a>&lt;T...&gt;&amp; operator=( <a class="code" href="classNorm.html">Norm&lt;T...&gt;</a> <span class="keyword">const</span>&amp; other)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>(<span class="keyword">this</span>==&amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">        super_type::operator=(other);</div><div class="line">         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <span class="keyword">inline</span>  <span class="keywordtype">double</span> Evaluate( T... <a name="a16"></a><a class="code" href="basic__distributions_8inl.html#a107bc7301b1b250d34c25693b90096c8">A</a> )<span class="keyword"> const </span>{</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> r=<a name="a17"></a><a class="code" href="basic__fit_8inl.html#a58e43a6eee990d884b2008760c6505c2">add</a>({<a class="code" href="basic__distributions_8inl.html#a107bc7301b1b250d34c25693b90096c8">A</a>...});</div><div class="line">        <span class="keywordflow">return</span> <a name="a18"></a><a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>( r );</div><div class="line">     };</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line"></div><div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> C&gt;</div><div class="line">    <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a></div><div class="line">    <span class="keyword">inline</span>  <a name="a19"></a><a class="code" href="basic__distributions_8inl.html#a4900ef306eb9271438791f1a98b8ccba">C</a> <a class="code" href="basic__fit_8inl.html#a58e43a6eee990d884b2008760c6505c2">add</a>( std::initializer_list&lt;C&gt; list   )<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line">        <a class="code" href="basic__distributions_8inl.html#a4900ef306eb9271438791f1a98b8ccba">C</a> r{};</div><div class="line">        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x: list)</div><div class="line">            r+=x;</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> r;</div><div class="line">    }</div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> ...Amplitudes&gt;</div><div class="line"><span class="keyword">auto</span> <a name="a20"></a><a class="code" href="dalitz__plot_8inl.html#a630cce9ea90101383d390eb695bd2f86">make_model</a>( Amplitudes <span class="keyword">const</span>&amp; ... amplitudes)</div><div class="line">-&gt; decltype(<a name="a21"></a><a class="code" href="namespacehydra.html#a86c018d960aacf7e0b79a20946aff059">hydra::compose</a>( std::declval&lt;<a class="code" href="classNorm.html">Norm&lt;typename Amplitudes::return_type...&gt;</a>&gt;(), amplitudes... ))</div><div class="line">{</div><div class="line">    <span class="keyword">auto</span> <a name="a22"></a><a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a> = <a class="code" href="namespacehydra.html#a86c018d960aacf7e0b79a20946aff059">hydra::compose</a>(<a class="code" href="classNorm.html">Norm&lt;typename Amplitudes::return_type...&gt;</a>()  , amplitudes...);</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude&gt;</div><div class="line">TH3D <a name="a23"></a><a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>( Amplitude <span class="keyword">const</span>&amp; amp, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a name="a24"></a><a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> <a name="a25"></a><a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude, <span class="keyword">typename</span> Model&gt;</div><div class="line"><span class="keywordtype">double</span> <a name="a26"></a><a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>( Amplitude <span class="keyword">const</span>&amp; amp, Model <span class="keyword">const</span>&amp; <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, <span class="keywordtype">size_t</span> <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Backend, <span class="keyword">typename</span> Model, <span class="keyword">typename</span> Container &gt;</div><div class="line"><span class="keywordtype">size_t</span> <a name="a27"></a><a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a name="a28"></a><a class="code" href="namespacehydra_1_1detail.html#a1461b18b118ced9f91233acbe90fd897">Backend</a> <span class="keyword">const</span>&amp; system, Model <span class="keyword">const</span>&amp; <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, Container&amp; decays, <span class="keywordtype">size_t</span> nevents, <span class="keywordtype">size_t</span> bunch_size);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a name="a29"></a><a class="code" href="dalitz__plot_8inl.html#a1c03069360f1f90a556eb537e0ff8a72">main</a>(<span class="keywordtype">int</span> argv, <span class="keywordtype">char</span>** <a name="a30"></a><a class="code" href="basic__fit_8inl.html#a27fb769f88c3c17ca3490b75f7758431">argc</a>)</div><div class="line">{</div><div class="line">    <span class="keywordtype">size_t</span> <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a> = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line"></div><div class="line">        TCLAP::CmdLine cmd(<span class="stringliteral">&quot;Command line arguments for &quot;</span>, <span class="charliteral">&#39;=&#39;</span>);</div><div class="line"></div><div class="line">        TCLAP::ValueArg&lt;size_t&gt; <a name="a31"></a><a class="code" href="basic__fit_8inl.html#a32ea8a498b202f85a8d77adaac39ca1b">EArg</a>(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;number-of-events&quot;</span>,<span class="stringliteral">&quot;Number of events&quot;</span>, <span class="keyword">true</span>, 10e6, <span class="stringliteral">&quot;size_t&quot;</span>);</div><div class="line">        cmd.add(<a class="code" href="basic__fit_8inl.html#a32ea8a498b202f85a8d77adaac39ca1b">EArg</a>);</div><div class="line"></div><div class="line">        <span class="comment">// Parse the argv array.</span></div><div class="line">        cmd.parse(argv, <a class="code" href="basic__fit_8inl.html#a27fb769f88c3c17ca3490b75f7758431">argc</a>);</div><div class="line"></div><div class="line">        <span class="comment">// Get the value parsed by each arg.</span></div><div class="line">        <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a> = <a class="code" href="basic__fit_8inl.html#a32ea8a498b202f85a8d77adaac39ca1b">EArg</a>.getValue();</div><div class="line"></div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (TCLAP::ArgException &amp;e)  {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;error: &quot;</span> &lt;&lt; e.error() &lt;&lt; <span class="stringliteral">&quot; for arg &quot;</span> &lt;&lt; e.argId()</div><div class="line">                                                        &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">//-----------------</span></div><div class="line">    <span class="comment">//magnitudes and phases from Cleo-c model</span></div><div class="line">    <span class="comment">//https://arxiv.org/pdf/0802.4214.pdf</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> NR_MAG         = 7.4;</div><div class="line">    <span class="keywordtype">double</span> NR_PHI         = (-18.4+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> NR_CRe         = NR_MAG*<a name="a32"></a><a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(NR_PHI);</div><div class="line">    <span class="keywordtype">double</span> NR_CIm         = NR_MAG*<a name="a33"></a><a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(NR_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> K800_MASS      = 0.809 ;</div><div class="line">    <span class="keywordtype">double</span> K800_WIDTH     = 0.470;</div><div class="line">    <span class="keywordtype">double</span> K800_MAG       = 5.01;</div><div class="line">    <span class="keywordtype">double</span> K800_PHI       = (-163.7+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> K800_CRe       = K800_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(K800_PHI);</div><div class="line">    <span class="keywordtype">double</span> K800_CIm       = K800_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(K800_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST_892_MASS   = 0.89555;</div><div class="line">    <span class="keywordtype">double</span> KST_892_WIDTH  = 0.0473;</div><div class="line">    <span class="keywordtype">double</span> KST_892_MAG    = 1.0;</div><div class="line">    <span class="keywordtype">double</span> KST_892_PHI    = 0.0;</div><div class="line">    <span class="keywordtype">double</span> KST_892_CRe    = KST_892_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST_892_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST_892_CIm    = KST_892_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST_892_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST0_1430_MASS  = 1.425;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_WIDTH = 0.270;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_MAG   = 3.5;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_PHI   = (49.7-180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_CRe   = KST0_1430_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST0_1430_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_CIm   = KST0_1430_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST0_1430_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST2_1430_MASS  = 1.4324;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_WIDTH = 0.109;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_MAG   = 0.962;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_PHI   = (-29.9+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_CRe   = KST2_1430_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST2_1430_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_CIm   = KST2_1430_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST2_1430_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST_1680_MASS  = 1.718;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_WIDTH = 0.322;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_MAG   = 6.5;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_PHI   = (29.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_CRe   = KST_1680_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST_1680_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST_1680_CIm   = KST_1680_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST_1680_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> D_MASS         = 1.86959;</div><div class="line">    <span class="keywordtype">double</span> K_MASS         = 0.493677;  <span class="comment">// K+ mass</span></div><div class="line">    <span class="keywordtype">double</span> PI_MASS        = 0.13957061;<span class="comment">// pi mass</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K(800)</span></div><div class="line">    <span class="keyword">auto</span> <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>    = <a name="a34"></a><a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a name="a35"></a><a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_K800&quot;</span> ).<a name="a36"></a><a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_MASS ).<a name="a37"></a><a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a name="a38"></a><a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_MASS*0.95,  K800_MASS*1.05 );</div><div class="line">    <span class="keyword">auto</span> <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_K800&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_WIDTH*0.95, K800_WIDTH*1.05);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_K800&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_CRe*0.95,K800_CRe*1.05);</div><div class="line">    <span class="keyword">auto</span> coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_K800&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_CIm*0.95,K800_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;hydra::SWave&gt;</a> K800_Resonance(coef_re, coef_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*(892)</span></div><div class="line">    <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_MASS*0.95,  KST_892_MASS*1.05 );</div><div class="line">    <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST_892&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_WIDTH*0.95, KST_892_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_CRe*0.95,KST_892_CRe*1.05).<a name="a39"></a><a class="code" href="group__fit.html#a9e217727a2c65f70ccf173398e69ee35">Fixed</a>();</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_CIm*0.95,KST_892_CIm*1.05).<a class="code" href="group__fit.html#a9e217727a2c65f70ccf173398e69ee35">Fixed</a>();</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;hydra::PWave&gt;</a> KST_892_Resonance(coef_re, coef_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*0(1430)</span></div><div class="line">    <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_MASS*0.95,  KST0_1430_MASS*1.05 );</div><div class="line">    <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST0_1430&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_WIDTH*0.95, KST0_1430_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_CRe*0.95,KST0_1430_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_CIm*0.95,KST0_1430_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;hydra::SWave&gt;</a> KST0_1430_Resonance(coef_re, coef_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*2(1430)</span></div><div class="line">    <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_MASS*0.95,  KST2_1430_MASS*1.05 );</div><div class="line">    <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST2_1430&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_WIDTH*0.95, KST2_1430_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_CRe*0.95,KST2_1430_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_CIm*0.95,KST2_1430_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;hydra::DWave&gt;</a> KST2_1430_Resonance(coef_re, coef_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*(1680)</span></div><div class="line">    <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_MASS*0.95,  KST_1680_MASS*1.05 );</div><div class="line">    <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST_1680&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_WIDTH*0.95, KST_1680_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_CRe*0.95,KST_1680_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_CIm*0.95,KST_1680_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;hydra::PWave&gt;</a> KST_1680_Resonance(coef_re, coef_im, <a class="code" href="basic__distributions_8inl.html#abb39a36b520aa64394409998d008eea0">mass</a>, <a class="code" href="breit__wigner__plus__chebychev_8inl.html#a59048b9d042712cd265ed1b0f46522d7">width</a>, D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//NR</span></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_NR&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(NR_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(NR_CRe*0.95,NR_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_NR&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(NR_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(NR_CIm*0.95,NR_CIm*1.05);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> NR = <a class="code" href="classNonResonant.html">NonResonant</a>(coef_re, coef_im);</div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//Total: Model |N.R + \sum{ Resonaces }|^2</span></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> Model = <a class="code" href="dalitz__plot_8inl.html#a630cce9ea90101383d390eb695bd2f86">make_model</a>( K800_Resonance, KST_892_Resonance,</div><div class="line">            KST0_1430_Resonance, KST2_1430_Resonance,</div><div class="line">            KST_1680_Resonance, NR );</div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    hydra::Vector4R <a name="a40"></a><a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6e5b99014b99eed9f49e72f2cf0fecea">B0</a>(D_MASS, 0.0, 0.0, 0.0);</div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi J/psi</span></div><div class="line">    <a name="_a41"></a><a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> <a name="a42"></a><a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>{D_MASS ,{K_MASS, PI_MASS, PI_MASS}};</div><div class="line"></div><div class="line">    <span class="comment">// functor to calculate the 2-body masses</span></div><div class="line">    <span class="keyword">auto</span> <a name="a43"></a><a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#ac6f5e94612d6b780788d65ee98888798">dalitz_calculator</a> = <a name="a44"></a><a class="code" href="namespacehydra.html#a094f4a025290ae35ad9eb8c553c7fc61">hydra::wrap_lambda</a>(</div><div class="line">            [] <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a> ( Kaon kaon, PionA pion1, PionB pion2)</div><div class="line">            {</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span>   M2_12 = (kaon + pion1).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_13 = (kaon + pion2).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_23 = (pion1+ pion2).mass2();</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a name="a45"></a><a class="code" href="namespacehydra.html#ae9e1c8df3eaea2b9e4646c5dcdeaf322">hydra::make_tuple</a>(M2_12, M2_13, M2_23);</div><div class="line">    });</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line">    TH3D Dalitz_Resonances(<span class="stringliteral">&quot;Dalitz_Resonances&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Dalitz - Toy Data -;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{1}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{2}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi_{1}^{+} #pi_{2}^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a name="a46"></a><a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line"></div><div class="line">    TH3D Dalitz_Fit(<span class="stringliteral">&quot;Dalitz_Fit&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Dalitz - Fit -;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{1}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{2}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi_{1}^{+} #pi_{2}^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//control plots</span></div><div class="line">    TH2D Normalization(<span class="stringliteral">&quot;normalization&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Model PDF Normalization;Norm;Error&quot;</span>,</div><div class="line">            200, 275.0, 305.0,</div><div class="line">            200, 0.58, 0.64);</div><div class="line"></div><div class="line"></div><div class="line">    TH3D  KST800_HIST , KST892_HIST, KST1425_HIST, KST1430_HIST,</div><div class="line">          KST1680_HIST, NR_HIST ;</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span>  KST800_FF, KST892_FF, KST1425_FF, KST1430_FF, KST1680_FF, NR_FF;</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    <a name="_a47"></a><a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>, <a name="_a48"></a><a class="code" href="namespacehydra_1_1detail.html#structhydra_1_1detail_1_1BackendPolicy">hydra::host::sys_t</a> &gt; toy_data(D_MASS, {K_MASS, PI_MASS, PI_MASS});</div><div class="line"></div><div class="line">    <span class="comment">//toy data production on device</span></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======= 1 - GENERATE TOY-DATA ========&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a name="a49"></a><a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        <a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a name="a50"></a><a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, Model,  {D_MASS, K_MASS, PI_MASS}, toy_data, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>, 2*<a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a name="a51"></a><a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; <a name="a52"></a><a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a> = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> - <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a>;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| D+ -&gt; K- pi+ pi+&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; toy_data.size()         &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a>.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        std::cout &lt;&lt; std::endl &lt;&lt;<span class="stringliteral">&quot;Toy Dataset size: &quot;</span>&lt;&lt; toy_data.size() &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    }<span class="comment">//toy data production on device</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//plot toy-data</span></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;========= 2 - PLOT TOY-DATA ==========&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt;  std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>, <a class="code" href="namespacehydra_1_1detail.html#structhydra_1_1detail_1_1BackendPolicy">hydra::device::sys_t</a> &gt; toy_data_temp(toy_data);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> dalitz_variables = toy_data_temp | <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#ac6f5e94612d6b780788d65ee98888798">dalitz_calculator</a>;</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;======= [Daliz variables] { ( MSq_12, MSq_13, MSq_23) } =======&gt;&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i=0; i&lt;10; i++ )</div><div class="line">            std::cout &lt;&lt; dalitz_variables[i] &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//flat dalitz histogram</span></div><div class="line">        <a name="_a53"></a><a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Dalitz{</div><div class="line">            {100,100,100},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">        };</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        Hist_Dalitz.Fill( dalitz_variables );</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a> = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> - <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a>;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Sparse histogram fill&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a>.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"><span class="preprocessor">#if HYDRA_DEVICE_SYSTEM==CUDA</span></div><div class="line"></div><div class="line">        <span class="comment">//if device is cuda, bring the histogram data to the host</span></div><div class="line">        <span class="comment">//to fill the ROOT histogram faster</span></div><div class="line">        {</div><div class="line">            <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::host::sys_t&gt;</a> Hist_Temp(Hist_Dalitz);</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Temp)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">                <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">                Hist_Temp.GetIndexes(bin, bins);</div><div class="line">                Dalitz_Resonances.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">            }</div><div class="line">        }</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Dalitz)</div><div class="line">        {</div><div class="line">            <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">            <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">            Hist_Dalitz.GetIndexes(bin, bins);</div><div class="line">            Dalitz_Resonances.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//fit on device</span></div><div class="line"></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;=============== 3 - FIT ==============&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt;  std::endl &lt;&lt; std::endl;</div><div class="line">        <span class="comment">//pdf</span></div><div class="line">        <span class="keyword">auto</span> Model_PDF = <a name="a54"></a><a class="code" href="group__fit.html#ga2d468a0d98a74f41479f8ccb95f5533e">hydra::make_pdf</a>( Model,</div><div class="line">                <a name="_a55"></a><a class="code" href="group__phsp.html#classhydra_1_1PhaseSpaceIntegrator">hydra::PhaseSpaceIntegrator&lt;3, hydra::device::sys_t&gt;</a>(D_MASS, {K_MASS, PI_MASS, PI_MASS}, 500000));</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt;<span class="stringliteral">&quot;| Initial PDF Norm: &quot;</span>&lt;&lt; Model_PDF.GetNorm() &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt;   Model_PDF.GetNormError() &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>, <a class="code" href="namespacehydra_1_1detail.html#structhydra_1_1detail_1_1BackendPolicy">hydra::device::sys_t</a> &gt; particles(toy_data);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a name="a56"></a><a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a> = <a name="a57"></a><a class="code" href="group__fit.html#ga7cb37dfdb2198202b4cb3f0b79f94080">hydra::make_loglikehood_fcn</a>(Model_PDF, particles.begin(),</div><div class="line">                particles.end());</div><div class="line"></div><div class="line">        <span class="comment">//print level</span></div><div class="line">        ROOT::Minuit2::MnPrint::SetGlobalLevel(3);</div><div class="line">        <a name="a58"></a><a class="code" href="classhydra_1_1Print.html#af480c3aae8aa72e3c10f1a4d64930dc6">hydra::Print::SetLevel</a>(<a name="a59"></a><a class="code" href="namespacehydra.html#a1107488f838687e73b39ddd8245f40d0a1bf857a06d5b8463494a6fcac6f4ea26">hydra::WARNING</a>);</div><div class="line"></div><div class="line">        <span class="comment">//minimization strategy</span></div><div class="line">        MnStrategy <a name="a60"></a><a class="code" href="binned__extended__logLL__fit_8inl.html#a606056a11d38679114392e4b9e9a52c0">strategy</a>(2);</div><div class="line"></div><div class="line">        <span class="comment">//create Migrad minimizer</span></div><div class="line">        MnMigrad <a name="a61"></a><a class="code" href="binned__extended__logLL__fit_8inl.html#aa0364f6c04ec4b6c9bb4a8182db8f973">migrad_d</a>(<a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>, <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetParameters().GetMnState() ,  <a class="code" href="binned__extended__logLL__fit_8inl.html#a606056a11d38679114392e4b9e9a52c0">strategy</a>);</div><div class="line"></div><div class="line">        <span class="comment">//print parameters before fitting</span></div><div class="line">        std::cout&lt;&lt;<a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetParameters().GetMnState()&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//Minimize and profile the time</span></div><div class="line">        <span class="keyword">auto</span> start_d = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        FunctionMinimum minimum_d =  FunctionMinimum( <a class="code" href="binned__extended__logLL__fit_8inl.html#aa0364f6c04ec4b6c9bb4a8182db8f973">migrad_d</a>(5000,250) );</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> end_d = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; <a name="a62"></a><a class="code" href="basic__fit__range__semantics_8inl.html#a1ba8521a327bf005305635e89ab116dd">elapsed_d</a> = end_d - start_d;</div><div class="line"></div><div class="line">        <span class="comment">//time</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| [Migrad] Time (ms) =&quot;</span>&lt;&lt; <a class="code" href="basic__fit__range__semantics_8inl.html#a1ba8521a327bf005305635e89ab116dd">elapsed_d</a>.count() &lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//print parameters after fitting</span></div><div class="line">        std::cout&lt;&lt;<span class="stringliteral">&quot;minimum: &quot;</span>&lt;&lt;minimum_d&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetParameters().UpdateParameters(minimum_d);</div><div class="line"></div><div class="line">        <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().PrintRegisteredParameters();</div><div class="line"></div><div class="line">        <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a> = 2000000;</div><div class="line">        <span class="comment">//----------</span></div><div class="line">        <span class="comment">//plotting fit results</span></div><div class="line">        <span class="comment">//allocate memory to hold the final states particles</span></div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>, <a class="code" href="namespacehydra_1_1detail.html#structhydra_1_1detail_1_1BackendPolicy">hydra::device::sys_t</a> &gt; fit_data(D_MASS, {K_MASS, PI_MASS, PI_MASS},<a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        <span class="comment">//generate the final state particles</span></div><div class="line">        <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.Generate(<a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6e5b99014b99eed9f49e72f2cf0fecea">B0</a>, fit_data);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a> = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> - <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a>;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------- Device (fit data) -----------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| D+ -&gt; K- pi+ pi+&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a>.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> dalitz_variables_fit = fit_data | <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#ac6f5e94612d6b780788d65ee98888798">dalitz_calculator</a>;</div><div class="line">        <span class="keyword">auto</span> dalitz_weights_fit   = fit_data | fit_data.GetEventWeightFunctor(<a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor());</div><div class="line"></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;======= [Daliz variables - fit] { weight : ( MSq_12, MSq_13, MSq_23) } =======&gt;&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i=0; i&lt;10; i++ )</div><div class="line">            std::cout &lt;&lt; dalitz_weights_fit[i] &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>&lt;&lt; dalitz_variables_fit[i] &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//model dalitz histogram</span></div><div class="line">        <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Dalitz{</div><div class="line">            {100,100,100},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">        };</div><div class="line"></div><div class="line">        <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        Hist_Dalitz.Fill( dalitz_variables_fit, dalitz_weights_fit);</div><div class="line"></div><div class="line">        <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a> = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a6be7d98960df33edf9f3998a9e8b2407">end</a> - <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a7f02a749754f40365411f74cf75d08fa">start</a>;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Sparse histogram fill&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; <a class="code" href="basic__fit_8inl.html#ac885494604ab75ca186fa2082a4261b8">elapsed</a>.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Optimized components</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">//fcn.GetParameters().UpdateParameters(minimum_d);</span></div><div class="line">        <span class="keyword">auto</span> Opt_Model = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor();</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST800  = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a63"></a><a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST892  = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a64"></a><a class="code" href="namespacehydra_1_1placeholders.html#adfba0f80c06fadc6694f3f3ad8ed68bc">_2</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1425 = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a65"></a><a class="code" href="namespacehydra_1_1placeholders.html#a09db94b16cc11622963193aaff7d90f1">_3</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1430 = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a66"></a><a class="code" href="namespacehydra_1_1placeholders.html#a6288ff68e8fe762e9cad1f9c3eb91854">_4</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1680 = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a67"></a><a class="code" href="namespacehydra_1_1placeholders.html#a1172a5be7d99dea7c49c7e858dd1be6d">_5</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> NR      = <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetFunctor().GetFunctor(<a name="a68"></a><a class="code" href="namespacehydra_1_1placeholders.html#a055c5b6a4cb2ea686a1080903ea068bc">_6</a>);</div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Draw components</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        KST800_HIST  =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST800,  {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST800_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST892_HIST  =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST892,  {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST892_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1425_HIST =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1425, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1425_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1430_HIST =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1430, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1430_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1680_HIST =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1680, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1680_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        NR_HIST      =  <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(NR,      {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;NR_HIST&quot;</span>, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Fit fractions</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        KST800_FF  =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST800 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST892_FF  =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST892 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1425_FF =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1425, Opt_Model, {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1430_FF =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1430, Opt_Model, {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        KST1680_FF =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1680, Opt_Model, {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">        NR_FF      =    <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(NR , Opt_Model,     {D_MASS, K_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST800_FF :&quot;</span>  &lt;&lt; KST800_FF  &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST892_FF :&quot;</span>  &lt;&lt; KST892_FF  &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1425_FF :&quot;</span> &lt;&lt; KST1425_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1430_FF :&quot;</span> &lt;&lt; KST1430_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1680_FF :&quot;</span> &lt;&lt; KST1680_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;NR_FF :&quot;</span>      &lt;&lt; NR_FF      &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sum :&quot;</span></div><div class="line">                  &lt;&lt; KST800_FF  +</div><div class="line">                     KST892_FF  +</div><div class="line">                     KST1425_FF +</div><div class="line">                     KST1430_FF +</div><div class="line">                     KST1680_FF +</div><div class="line">                     NR_FF  &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line">        {</div><div class="line">            std::vector&lt;double&gt; integrals;</div><div class="line">            std::vector&lt;double&gt; integrals_error;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> x: <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetNormCache() ){</div><div class="line">                integrals.push_back(x.second.first);</div><div class="line">                integrals_error.push_back(x.second.second);</div><div class="line"></div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keyword">auto</span> integral_bounds = std::minmax_element(integrals.begin(),</div><div class="line">                    integrals.end());</div><div class="line"></div><div class="line">            <span class="keyword">auto</span>  integral_error_bounds = std::minmax_element(integrals_error.begin(),</div><div class="line">                    integrals_error.end());</div><div class="line"></div><div class="line">            Normalization.GetXaxis()-&gt;SetLimits(*integral_bounds.first, *integral_bounds.second);</div><div class="line">            Normalization.GetYaxis()-&gt;SetLimits(*integral_error_bounds.first, *integral_error_bounds.second);</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> x: <a class="code" href="binned__extended__logLL__fit_8inl.html#aad15208f9f01c27dc8a4ccbbe0970fee">fcn</a>.GetPDF().GetNormCache() ){</div><div class="line"></div><div class="line">                Normalization.Fill(x.second.first, x.second.second );</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#if THRUST_DEVICE_SYSTEM == THRUST_DEVICE_SYSTEM_CUDA</span></div><div class="line"></div><div class="line">        <span class="comment">//if device is cuda, bring the histogram data to the host</span></div><div class="line">        <span class="comment">//to fill the ROOT histogram faster</span></div><div class="line">        {</div><div class="line">            <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::host::sys_t&gt;</a> Hist_Temp(Hist_Dalitz);</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Temp)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">                <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">                Hist_Temp.GetIndexes(bin, bins);</div><div class="line">                Dalitz_Fit.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">            }</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Dalitz)</div><div class="line">        {</div><div class="line">            <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">            <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">            Hist_Dalitz.GetIndexes(bin, bins);</div><div class="line">            Dalitz_Fit.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"></div><div class="line">    TApplication *m_app=<span class="keyword">new</span> TApplication(<span class="stringliteral">&quot;myapp&quot;</span>,0,0);</div><div class="line"></div><div class="line"></div><div class="line">    Dalitz_Fit.Scale(Dalitz_Resonances.Integral()/Dalitz_Fit.Integral() );</div><div class="line"></div><div class="line">    KST800_HIST.Scale(  KST800_FF*Dalitz_Fit.Integral()/KST800_HIST.Integral() );</div><div class="line"></div><div class="line">    KST892_HIST.Scale(  KST892_FF*Dalitz_Fit.Integral()/KST892_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1425_HIST.Scale( KST1425_FF*Dalitz_Fit.Integral()/KST1425_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1430_HIST.Scale( KST1430_FF*Dalitz_Fit.Integral()/KST1430_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1680_HIST.Scale( KST1680_FF*Dalitz_Fit.Integral()/KST1680_HIST.Integral() );</div><div class="line"></div><div class="line">    NR_HIST.Scale( NR_FF*Dalitz_Fit.Integral()/NR_HIST.Integral() );</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line">    <span class="comment">//projections</span></div><div class="line">    TH1* hist2D=0;</div><div class="line"></div><div class="line">    TCanvas canvas_3(<span class="stringliteral">&quot;canvas_3&quot;</span>, <span class="stringliteral">&quot;Dataset&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Resonances.Project3D(<span class="stringliteral">&quot;yz&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_3.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Dataset1.pdf&quot;</span>);</div><div class="line"></div><div class="line">    TCanvas canvas_4(<span class="stringliteral">&quot;canvas_4&quot;</span>, <span class="stringliteral">&quot;Dataset&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Resonances.Project3D(<span class="stringliteral">&quot;xy&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_4.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Dataset2.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    TCanvas canvas_5(<span class="stringliteral">&quot;canvas_5&quot;</span>, <span class="stringliteral">&quot;Fit&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Fit.Project3D(<span class="stringliteral">&quot;yz&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;SetStats(0);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_5.SaveAs(<span class="stringliteral">&quot;plots/dalitz/FitResult1.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    TCanvas canvas_6(<span class="stringliteral">&quot;canvas_4&quot;</span>, <span class="stringliteral">&quot;Phase-space FLAT&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Fit.Project3D(<span class="stringliteral">&quot;xy&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;SetStats(0);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_6.SaveAs(<span class="stringliteral">&quot;plots/dalitz/FitResult2.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line">    <span class="comment">//projections</span></div><div class="line">    TH1* hist=0;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* axis =0;</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST800_Color  = kViolet-5;</div><div class="line">    <span class="keyword">auto</span> KST892_Color  = kBlue;</div><div class="line">    <span class="keyword">auto</span> KST1425_Color = kGreen-2;</div><div class="line">    <span class="keyword">auto</span> KST1430_Color = kOrange-3;</div><div class="line">    <span class="keyword">auto</span> KST1680_Color = kYellow-2;</div><div class="line">    <span class="keyword">auto</span> NR_Color      = kBlack;</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> X1NDC = 0.262458;</div><div class="line">    <span class="keywordtype">double</span> Y1NDC = 0.127544;</div><div class="line">    <span class="keywordtype">double</span> X2NDC = 0.687708;</div><div class="line">    <span class="keywordtype">double</span> Y2NDC = 0.35;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//==============================</span></div><div class="line">    axis = <span class="stringliteral">&quot;x&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_x(<span class="stringliteral">&quot;canvas_x&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_x = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_x.SetEntrySeparation(0.3);</div><div class="line">    legend_x.SetNColumns(2);</div><div class="line">    legend_x.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;#kappa&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST892_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;K*(892)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1680_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;K_{1}(1680)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;K*_{0}(1425)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;K*_{2}(1430)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_x.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_X.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_x.SetLogy(1);</div><div class="line"></div><div class="line">    legend_x.Draw();</div><div class="line"></div><div class="line">    canvas_x.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogX.pdf&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line">    axis = <span class="stringliteral">&quot;y&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_y(<span class="stringliteral">&quot;canvas_y&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_y = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_y.SetEntrySeparation(0.3);</div><div class="line">    legend_y.SetNColumns(2);</div><div class="line">    legend_y.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;#kappa&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST892_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;K*(892)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1680_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;K_{1}(1680)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1425_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;K*_{0}(1425)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;K*_{2}(1430)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_y.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_Y.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_y.SetLogy(1);</div><div class="line"></div><div class="line">    legend_y.Draw();</div><div class="line"></div><div class="line">    canvas_y.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogY.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    axis = <span class="stringliteral">&quot;z&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_z(<span class="stringliteral">&quot;canvas_z&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_z = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_z.SetEntrySeparation(0.3);</div><div class="line">    legend_z.SetNColumns(2);</div><div class="line">    legend_z.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;#kappa&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST892_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;K*(892)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1680_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;K_{1}(1680)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;K*_{0}(1425)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1430_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;K*_{2}(1430)&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_z.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_Z.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_z.SetLogy(1);</div><div class="line"></div><div class="line">    legend_z.Draw();</div><div class="line"></div><div class="line">    canvas_z.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogZ.pdf&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line">    TCanvas canvas_7(<span class="stringliteral">&quot;canvas_7&quot;</span>, <span class="stringliteral">&quot;Normalization&quot;</span>, 500, 500);</div><div class="line">    Normalization.Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    m_app-&gt;Run();</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Backend, <span class="keyword">typename</span> Model, <span class="keyword">typename</span> Container &gt;</div><div class="line"><span class="keywordtype">size_t</span> <a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a class="code" href="namespacehydra_1_1detail.html#a1461b18b118ced9f91233acbe90fd897">Backend</a> <span class="keyword">const</span>&amp; system, Model <span class="keyword">const</span>&amp; <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, Container&amp; decays, <span class="keywordtype">size_t</span> nevents, <span class="keywordtype">size_t</span> bunch_size)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    hydra::Vector4R <a name="a69"></a><a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>(D_MASS, 0.0, 0.0, 0.0);</div><div class="line"></div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>{D_MASS, {K_MASS, PI_MASS, PI_MASS}};</div><div class="line"></div><div class="line">    <span class="comment">//allocate memory to hold the final states particles</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>, <a class="code" href="namespacehydra_1_1detail.html#a1461b18b118ced9f91233acbe90fd897">Backend</a> &gt; _data(D_MASS, {K_MASS, PI_MASS, PI_MASS}, bunch_size);</div><div class="line"></div><div class="line">    <a name="_a70"></a><a class="code" href="classhydra_1_1SeedRNG.html">hydra::SeedRNG</a> S{};</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">do</span> {</div><div class="line">        <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.SetSeed(S());</div><div class="line"></div><div class="line">        <span class="comment">//generate the final state particles</span></div><div class="line">        <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.Generate(<a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>, _data );</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a name="a71"></a><a class="code" href="namespacehydra.html#a5b5278e8bbc808a52856865a2a39dba7">sample</a> = _data.Unweight(<a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>, -1, S());</div><div class="line"></div><div class="line">        decays.insert(decays.end(), <a class="code" href="namespacehydra.html#a5b5278e8bbc808a52856865a2a39dba7">sample</a>.begin(), <a class="code" href="namespacehydra.html#a5b5278e8bbc808a52856865a2a39dba7">sample</a>.end());</div><div class="line"></div><div class="line">    } <span class="keywordflow">while</span>(decays.size() &lt; (nevents+1) );</div><div class="line"></div><div class="line">    decays.erase(decays.begin()+nevents, decays.end());</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> decays.size();</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude, <span class="keyword">typename</span> Model&gt;</div><div class="line"><span class="keywordtype">double</span> <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>( Amplitude <span class="keyword">const</span>&amp; amp, Model <span class="keyword">const</span>&amp; <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, <span class="keywordtype">size_t</span> <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    hydra::Vector4R <a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>(D_MASS, 0.0, 0.0, 0.0);</div><div class="line"></div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>{D_MASS,{K_MASS, PI_MASS, PI_MASS}};</div><div class="line"></div><div class="line">    <span class="comment">//norm lambda</span></div><div class="line">    <span class="keyword">auto</span> <a class="code" href="classNorm.html">Norm</a> = <a class="code" href="namespacehydra.html#a094f4a025290ae35ad9eb8c553c7fc61">hydra::wrap_lambda</a>( [] <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a> ( <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a> x){</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>(x);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//functor</span></div><div class="line">    <span class="keyword">auto</span> functor = <a class="code" href="namespacehydra.html#a86c018d960aacf7e0b79a20946aff059">hydra::compose</a>(<a class="code" href="classNorm.html">Norm</a>, amp);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> amp_int   = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.AverageOn(<a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, <a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>, functor, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line">    <span class="keyword">auto</span> model_int = <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.AverageOn(<a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, <a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>, <a class="code" href="basic__fit__range__semantics_8inl.html#a4494b924b71b8932dedd0783a4e7061f">model</a>,   <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> amp_int.first/model_int.first;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude&gt;</div><div class="line">TH3D <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>( Amplitude <span class="keyword">const</span>&amp; amp, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = <a class="code" href="phsp__unweighting_8inl.html#ad507bdbe1cd7219fead6e9dcd287d908">masses</a>[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    TH3D Component(name,</div><div class="line">            <span class="stringliteral">&quot;;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi^{+} #pi^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    hydra::Vector4R <a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>(D_MASS, 0.0, 0.0, 0.0);</div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>{D_MASS, {K_MASS, PI_MASS, PI_MASS}};</div><div class="line"></div><div class="line">    <span class="comment">// functor to calculate the 2-body masses</span></div><div class="line">    <span class="keyword">auto</span> <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#ac6f5e94612d6b780788d65ee98888798">dalitz_calculator</a> = <a class="code" href="namespacehydra.html#a094f4a025290ae35ad9eb8c553c7fc61">hydra::wrap_lambda</a>(</div><div class="line">                [] <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a> ( Kaon kaon, PionA pion1, PionB pion2)</div><div class="line">                {</div><div class="line"></div><div class="line">            <span class="keywordtype">double</span>   M2_12 = (kaon + pion1).mass2();</div><div class="line">            <span class="keywordtype">double</span>   M2_13 = (kaon + pion2).mass2();</div><div class="line">            <span class="keywordtype">double</span>   M2_23 = (pion1+ pion2).mass2();</div><div class="line"></div><div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ae9e1c8df3eaea2b9e4646c5dcdeaf322">hydra::make_tuple</a>(M2_12, M2_13, M2_23);</div><div class="line">        });</div><div class="line"></div><div class="line">    <span class="comment">//norm lambda</span></div><div class="line">    <span class="keyword">auto</span> <a class="code" href="classNorm.html">Norm</a> = <a class="code" href="namespacehydra.html#a094f4a025290ae35ad9eb8c553c7fc61">hydra::wrap_lambda</a>(</div><div class="line">            [] <a class="code" href="Config_8h.html#a12fed978a9eb30299d0dc151384dcf3b">__hydra_dual__</a> ( <a class="code" href="namespacehydra.html#a9d2c06cb9672fe86dbeaa65e8f35a2bf">hydra::complex&lt;double&gt;</a> x){</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>(x);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//functor</span></div><div class="line">    <span class="keyword">auto</span> functor = <a class="code" href="namespacehydra.html#a86c018d960aacf7e0b79a20946aff059">hydra::compose</a>(<a class="code" href="classNorm.html">Norm</a>, amp);</div><div class="line"></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;hydra::tuple&lt;Kaon,PionA,PionB&gt;</a>,</div><div class="line">             <a class="code" href="namespacehydra_1_1detail.html#structhydra_1_1detail_1_1BackendPolicy">hydra::device::sys_t</a> &gt; events(D_MASS, {K_MASS, PI_MASS, PI_MASS}, <a class="code" href="basic__fit_8inl.html#af8b0f365ee5d5b76a62688733e5016a1">nentries</a>);</div><div class="line"></div><div class="line">    <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#a2ef988f1e86ed75cae4059bc8367bac5">phsp</a>.Generate(<a class="code" href="basic__distributions_8inl.html#a6f9cfa21f3993da1ed1a77acbc9bd9be">D</a>, events);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> dalitz_variables = events | <a class="code" href="phsp__unweighting__functor__and__fit_8inl.html#ac6f5e94612d6b780788d65ee98888798">dalitz_calculator</a>;</div><div class="line">    <span class="keyword">auto</span> dalitz_weights   = events | events.GetEventWeightFunctor(functor);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//model dalitz histogram</span></div><div class="line">    <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Component{</div><div class="line">        {100,100,100},</div><div class="line">        {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">        {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">    };</div><div class="line"></div><div class="line">    Hist_Component.Fill( dalitz_variables, dalitz_weights );</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Component){</div><div class="line"></div><div class="line">        <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">        <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">        Hist_Component.GetIndexes(bin, bins);</div><div class="line">        Component.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> Component;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#endif </span><span class="comment">/* DALITZ_PLOT_INL_ */</span><span class="preprocessor"></span></div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Dec 3 2023 21:29:46 for Hydra by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
