<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hydra: dalitz_plot.inl</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hydra
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">A header-only templated C++ framework to perform data analysis on massively parallel platforms.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dalitz_plot_8inl-example.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dalitz_plot.inl</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*----------------------------------------------------------------------------</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Copyright (C) 2016 - 2018 Antonio Augusto Alves Junior</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   This file is part of Hydra Data Analysis Framework.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Hydra is free software: you can redistribute it and/or modify</span></div><div class="line"><span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><span class="comment"> *   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><span class="comment"> *   (at your option) any later version.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   Hydra is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><span class="comment"> *   along with Hydra.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *---------------------------------------------------------------------------*/</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * dalitz_plot.inl</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> *  Created on: 29/12/2017</span></div><div class="line"><span class="comment"> *      Author: Antonio Augusto Alves Junior</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef DALITZ_PLOT_INL_</span></div><div class="line"><span class="preprocessor">#define DALITZ_PLOT_INL_</span></div><div class="line"></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * \example dalitz_plot.inl</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;random&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//command line</span></div><div class="line"><span class="preprocessor">#include &lt;tclap/CmdLine.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//hydra</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="host_2System_8h.html">hydra/host/System.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="device_2System_8h.html">hydra/device/System.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Function_8h.html">hydra/Function.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="FunctionWrapper_8h.html">hydra/FunctionWrapper.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="FunctorArithmetic_8h.html">hydra/FunctorArithmetic.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Placeholders_8h.html">hydra/Placeholders.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Complex_8h.html">hydra/Complex.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Tuple_8h.html">hydra/Tuple.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="GenericRange_8h.html">hydra/GenericRange.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Distance_8h.html">hydra/Distance.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="LogLikelihoodFCN_8h.html">hydra/LogLikelihoodFCN.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Parameter_8h.html">hydra/Parameter.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="UserParameters_8h.html">hydra/UserParameters.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Pdf_8h.html">hydra/Pdf.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="AddPdf_8h.html">hydra/AddPdf.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Vector4R_8h.html">hydra/Vector4R.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PhaseSpace_8h.html">hydra/PhaseSpace.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PhaseSpaceIntegrator_8h.html">hydra/PhaseSpaceIntegrator.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Decays_8h.html">hydra/Decays.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="DenseHistogram_8h.html">hydra/DenseHistogram.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SparseHistogram_8h.html">hydra/SparseHistogram.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="BreitWignerLineShape_8h.html">hydra/functions/BreitWignerLineShape.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="WignerDFunctions_8h.html">hydra/functions/WignerDFunctions.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="CosHelicityAngle_8h.html">hydra/functions/CosHelicityAngle.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ZemachFunctions_8h.html">hydra/functions/ZemachFunctions.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//Minuit2</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/FunctionMinimum.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnUserParameterState.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnPrint.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnMigrad.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Minuit2/MnMinimize.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">/*-------------------------------------</span></div><div class="line"><span class="comment"> * Include classes from ROOT to fill</span></div><div class="line"><span class="comment"> * and draw histograms and plots.</span></div><div class="line"><span class="comment"> *-------------------------------------</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#ifdef _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;TROOT.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH1D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH2D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TH3D.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TApplication.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TCanvas.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TLegend.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;TLegendEntry.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif //_ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceROOT_1_1Minuit2.html">ROOT::Minuit2</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacehydra_1_1placeholders.html">hydra::placeholders</a>;</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CHANNEL, hydra::Wave L&gt;</div><div class="line"><span class="keyword">class </span><a name="_a0"></a><a class="code" href="classResonance.html">Resonance</a>: <span class="keyword">public</span> <a name="_a1"></a><a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;Resonance&lt;CHANNEL,L&gt;, hydra::complex&lt;double&gt;, 4&gt;</div><div class="line">{</div><div class="line">    <span class="keyword">using</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;Resonance&lt;CHANNEL,L&gt;</a>, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>, 4&gt;::_par;</div><div class="line"></div><div class="line">    constexpr <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _I1 = CHANNEL-1;</div><div class="line">    constexpr <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _I2 = (CHANNEL!=3)*CHANNEL;</div><div class="line">    constexpr <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _I3 = 3-( (CHANNEL-1) + (CHANNEL!=3)*CHANNEL );</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>() = <span class="keyword">delete</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>(<a name="_a2"></a><a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_re, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_im,</div><div class="line">            <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; mass, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; width,</div><div class="line">            <span class="keywordtype">double</span> mother_mass, <span class="keywordtype">double</span> daugther1_mass,</div><div class="line">            <span class="keywordtype">double</span> daugther2_mass, <span class="keywordtype">double</span> daugther3_mass,</div><div class="line">            <span class="keywordtype">double</span> radi):</div><div class="line">            <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;Resonance&lt;CHANNEL,L&gt;</a>, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>, 4&gt;{c_re, c_im, mass, width},</div><div class="line">            fLineShape(mass, width, mother_mass, daugther1_mass, daugther2_mass, daugther3_mass, radi)</div><div class="line">    {}</div><div class="line"></div><div class="line"></div><div class="line">    __hydra_dual__</div><div class="line">    <a class="code" href="classResonance.html">Resonance</a>( <a class="code" href="classResonance.html">Resonance&lt; CHANNEL,L&gt;</a> <span class="keyword">const</span>&amp; other):</div><div class="line">    <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;Resonance&lt;CHANNEL ,L&gt;</a>, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>, 4&gt;(other),</div><div class="line">    fLineShape(other.<a name="a3"></a><a class="code" href="classResonance.html#af7b090d1a1ab80908aada16b1a8164e4">GetLineShape</a>())</div><div class="line">    {}</div><div class="line"></div><div class="line">    __hydra_dual__  <span class="keyword">inline</span></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt; CHANNEL ,L&gt;</a>&amp;</div><div class="line">    operator=( <a class="code" href="classResonance.html">Resonance&lt; CHANNEL ,L&gt;</a> <span class="keyword">const</span>&amp; other)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>(<span class="keyword">this</span>==&amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"></div><div class="line">        <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;Resonance&lt;CHANNEL ,L&gt;</a>, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>, 4&gt;::operator=(other);</div><div class="line">        fLineShape=other.<a name="a4"></a><a class="code" href="classResonance.html#af7b090d1a1ab80908aada16b1a8164e4">GetLineShape</a>();</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    __hydra_dual__  <span class="keyword">inline</span></div><div class="line">    <a name="_a5"></a><a class="code" href="classhydra_1_1BreitWignerLineShape.html">hydra::BreitWignerLineShape&lt;L&gt;</a> <span class="keyword">const</span>&amp; GetLineShape()<span class="keyword"> const </span>{    <span class="keywordflow">return</span> fLineShape; }</div><div class="line"></div><div class="line">    __hydra_dual__  <span class="keyword">inline</span></div><div class="line">    <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a> Evaluate(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a name="_a6"></a><a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a>* p)<span class="keyword">  const </span>{</div><div class="line"></div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> p1 = p[_I1];</div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> p2 = p[_I2];</div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> p3 = p[_I3];</div><div class="line"></div><div class="line"></div><div class="line">        fLineShape.SetParameter(0, _par[2]);</div><div class="line">        fLineShape.SetParameter(1, _par[3]);</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span> theta = fCosDecayAngle( (p1+p2+p3), (p1+p2), p1 );</div><div class="line">        <span class="keywordtype">double</span> angular = fAngularDist(theta);</div><div class="line">        <span class="keyword">auto</span> r = <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>(_par[0], _par[1])*fLineShape((p1+p2).mass())*angular;</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> r;</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line"></div><div class="line">    <span class="keyword">mutable</span> <a class="code" href="classhydra_1_1BreitWignerLineShape.html">hydra::BreitWignerLineShape&lt;L&gt;</a> fLineShape;</div><div class="line">    <a name="_a7"></a><a class="code" href="classhydra_1_1CosHelicityAngle.html">hydra::CosHelicityAngle</a> fCosDecayAngle;</div><div class="line">    <a name="_a8"></a><a class="code" href="classhydra_1_1ZemachFunction.html">hydra::ZemachFunction&lt;L&gt;</a> fAngularDist;</div><div class="line"></div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">class </span><a name="_a9"></a><a class="code" href="classNonResonant.html">NonResonant</a>: <span class="keyword">public</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor</a>&lt;NonResonant, hydra::complex&lt;double&gt;, 2&gt;</div><div class="line">{</div><div class="line"></div><div class="line">    <span class="keyword">using</span> <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;NonResonant, hydra::complex&lt;double&gt;</a>, 2&gt;::_par;</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>() = <span class="keyword">delete</span>;</div><div class="line"></div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>(<a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_re, <a class="code" href="group__fit.html#structhydra_1_1Parameter">hydra::Parameter</a> <span class="keyword">const</span>&amp; c_im):</div><div class="line">            <a class="code" href="namespacehydra.html">hydra</a>::BaseFunctor&lt;<a class="code" href="classNonResonant.html">NonResonant</a>, <a class="code" href="namespacehydra.html">hydra</a>::<a name="a10"></a><a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">complex</a>&lt;<a name="_a11"></a><a class="code" href="namespace_3globalScope_4.html#classdouble">double</a>&gt;, 2&gt;{c_re, c_im}</div><div class="line">    {}</div><div class="line"></div><div class="line"></div><div class="line">     __hydra_dual__</div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>( <a class="code" href="classNonResonant.html">NonResonant</a> <span class="keyword">const</span>&amp; other):</div><div class="line">    <a class="code" href="namespacehydra.html">hydra</a>::BaseFunctor&lt;<a class="code" href="classNonResonant.html">NonResonant</a>, <a class="code" href="namespacehydra.html">hydra</a>::<a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">complex</a>&lt;<a class="code" href="namespace_3globalScope_4.html#classdouble">double</a>&gt;, 2&gt;(other)</div><div class="line">    {}</div><div class="line"></div><div class="line">     __hydra_dual__</div><div class="line">    <a class="code" href="classNonResonant.html">NonResonant</a>&amp; operator=( <a class="code" href="classNonResonant.html">NonResonant</a> <span class="keyword">const</span>&amp; other)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span>(<span class="keyword">this</span>==&amp;other) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"></div><div class="line">        <a class="code" href="group__functor.html#classhydra_1_1BaseFunctor">hydra::BaseFunctor&lt;NonResonant, hydra::complex&lt;double&gt;</a>, 2&gt;::operator=(other);</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">     __hydra_dual__  <span class="keyword">inline</span></div><div class="line">    <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a> Evaluate(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a>* p)<span class="keyword">  const </span>{</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>(_par[0], _par[1]);</div><div class="line">    }</div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude&gt;</div><div class="line">TH3D <a name="a12"></a><a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>( Amplitude <span class="keyword">const</span>&amp; amp, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> nentries);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude, <span class="keyword">typename</span> Model&gt;</div><div class="line"><span class="keywordtype">double</span> <a name="a13"></a><a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>( Amplitude <span class="keyword">const</span>&amp; amp, Model <span class="keyword">const</span>&amp; model, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, <span class="keywordtype">size_t</span> nentries);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Backend, <span class="keyword">typename</span> Model, <span class="keyword">typename</span> Container &gt;</div><div class="line"><span class="keywordtype">size_t</span> <a name="a14"></a><a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a name="a15"></a><a class="code" href="namespacehydra_1_1detail.html#a1461b18b118ced9f91233acbe90fd897">Backend</a> <span class="keyword">const</span>&amp; system, Model <span class="keyword">const</span>&amp; model, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, Container&amp; decays, <span class="keywordtype">size_t</span> nevents, <span class="keywordtype">size_t</span> bunch_size);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a name="a16"></a><a class="code" href="dalitz__plot_8inl.html#a1c03069360f1f90a556eb537e0ff8a72">main</a>(<span class="keywordtype">int</span> argv, <span class="keywordtype">char</span>** argc)</div><div class="line">{</div><div class="line">    <span class="keywordtype">size_t</span> nentries = 0;</div><div class="line"></div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line"></div><div class="line">        TCLAP::CmdLine cmd(<span class="stringliteral">&quot;Command line arguments for &quot;</span>, <span class="charliteral">&#39;=&#39;</span>);</div><div class="line"></div><div class="line">        TCLAP::ValueArg&lt;size_t&gt; EArg(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;number-of-events&quot;</span>,<span class="stringliteral">&quot;Number of events&quot;</span>, <span class="keyword">true</span>, 10e6, <span class="stringliteral">&quot;size_t&quot;</span>);</div><div class="line">        cmd.add(EArg);</div><div class="line"></div><div class="line">        <span class="comment">// Parse the argv array.</span></div><div class="line">        cmd.parse(argv, argc);</div><div class="line"></div><div class="line">        <span class="comment">// Get the value parsed by each arg.</span></div><div class="line">        nentries = EArg.getValue();</div><div class="line"></div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (TCLAP::ArgException &amp;e)  {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;error: &quot;</span> &lt;&lt; e.error() &lt;&lt; <span class="stringliteral">&quot; for arg &quot;</span> &lt;&lt; e.argId()</div><div class="line">                                                        &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">//-----------------</span></div><div class="line">    <span class="comment">//magnitudes and phases from Cleo-c model</span></div><div class="line">    <span class="comment">//https://arxiv.org/pdf/0802.4214.pdf</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> NR_MAG         = 4.8;</div><div class="line">    <span class="keywordtype">double</span> NR_PHI         = (-18.4+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> NR_CRe         = NR_MAG*<a name="a17"></a><a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(NR_PHI);</div><div class="line">    <span class="keywordtype">double</span> NR_CIm         = NR_MAG*<a name="a18"></a><a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(NR_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> K800_MASS      = 0.809 ;</div><div class="line">    <span class="keywordtype">double</span> K800_WIDTH     = 0.470;</div><div class="line">    <span class="keywordtype">double</span> K800_MAG       = 2.25;</div><div class="line">    <span class="keywordtype">double</span> K800_PHI       = (-163.7+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> K800_CRe       = K800_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(K800_PHI);</div><div class="line">    <span class="keywordtype">double</span> K800_CIm       = K800_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(K800_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST_892_MASS   = 0.89555;</div><div class="line">    <span class="keywordtype">double</span> KST_892_WIDTH  = 0.0473;</div><div class="line">    <span class="keywordtype">double</span> KST_892_MAG    = 1.0;</div><div class="line">    <span class="keywordtype">double</span> KST_892_PHI    = 0.0;</div><div class="line">    <span class="keywordtype">double</span> KST_892_CRe    = KST_892_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST_892_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST_892_CIm    = KST_892_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST_892_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST0_1430_MASS  = 1.425;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_WIDTH = 0.270;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_MAG   = 1.50;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_PHI   = (45.7-180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_CRe   = KST0_1430_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST0_1430_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST0_1430_CIm   = KST0_1430_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST0_1430_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST2_1430_MASS  = 1.4324;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_WIDTH = 0.109;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_MAG   = 0.962;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_PHI   = (-33.9+180.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_CRe   = KST2_1430_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST2_1430_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST2_1430_CIm   = KST2_1430_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST2_1430_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> KST_1680_MASS  = 1.718;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_WIDTH = 0.322;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_MAG   = 2.5;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_PHI   = (26.0)*0.01745329;</div><div class="line">    <span class="keywordtype">double</span> KST_1680_CRe   = KST_1680_MAG*<a class="code" href="namespacehydra.html#a82497912f037617b630d048bfcc515c0">cos</a>(KST_1680_PHI);</div><div class="line">    <span class="keywordtype">double</span> KST_1680_CIm   = KST_1680_MAG*<a class="code" href="namespacehydra.html#acb7d0e5da38544692eb3545e81617e19">sin</a>(KST_1680_PHI);</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> D_MASS         = 1.86959;</div><div class="line">    <span class="keywordtype">double</span> K_MASS         = 0.493677;  <span class="comment">// K+ mass</span></div><div class="line">    <span class="keywordtype">double</span> PI_MASS        = 0.13957061;<span class="comment">// pi mass</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K(800)</span></div><div class="line">    <span class="keyword">auto</span> mass    = <a name="a19"></a><a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a name="a20"></a><a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_K800&quot;</span> ).<a name="a21"></a><a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_MASS ).<a name="a22"></a><a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a name="a23"></a><a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_MASS*0.95,  K800_MASS*1.05 );</div><div class="line">    <span class="keyword">auto</span> width   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_K800&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_WIDTH*0.95, K800_WIDTH*1.05);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_K800&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_CRe*0.95,K800_CRe*1.05);</div><div class="line">    <span class="keyword">auto</span> coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_K800&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(K800_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(K800_CIm*0.95,K800_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;1, hydra::SWave&gt;</a> K800_Resonance_12(coef_re, coef_im, mass, width,</div><div class="line">                D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;3, hydra::SWave&gt;</a> K800_Resonance_13(coef_re, coef_im, mass, width,</div><div class="line">                    D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> K800_Resonance = (K800_Resonance_12 + K800_Resonance_13);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*(892)</span></div><div class="line">    mass    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_MASS*0.95,  KST_892_MASS*1.05 );</div><div class="line">    width   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST_892&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_WIDTH*0.95, KST_892_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_CRe*0.95,KST_892_CRe*1.05).<a name="a24"></a><a class="code" href="group__fit.html#a9e217727a2c65f70ccf173398e69ee35">Fixed</a>();</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST_892&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_892_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_892_CIm*0.95,KST_892_CIm*1.05).<a class="code" href="group__fit.html#a9e217727a2c65f70ccf173398e69ee35">Fixed</a>();</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;1, hydra::PWave&gt;</a> KST_892_Resonance_12(coef_re, coef_im, mass, width,</div><div class="line">                D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;3, hydra::PWave&gt;</a> KST_892_Resonance_13(coef_re, coef_im, mass, width,</div><div class="line">                    D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST_892_Resonance = (KST_892_Resonance_12 - KST_892_Resonance_13);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*0(1430)</span></div><div class="line">    mass    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_MASS*0.95,  KST0_1430_MASS*1.05 );</div><div class="line">    width   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST0_1430&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_WIDTH*0.95, KST0_1430_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_CRe*0.95,KST0_1430_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST0_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST0_1430_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST0_1430_CIm*0.95,KST0_1430_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;1, hydra::SWave&gt;</a> KST0_1430_Resonance_12(coef_re, coef_im, mass, width,</div><div class="line">                D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;3, hydra::SWave&gt;</a> KST0_1430_Resonance_13(coef_re, coef_im, mass, width,</div><div class="line">                    D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST0_1430_Resonance = (KST0_1430_Resonance_12 + KST0_1430_Resonance_13);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*2(1430)</span></div><div class="line">    mass    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_MASS*0.95,  KST2_1430_MASS*1.05 );</div><div class="line">    width   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST2_1430&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_WIDTH*0.95, KST2_1430_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_CRe*0.95,KST2_1430_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST2_1430&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST2_1430_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST2_1430_CIm*0.95,KST2_1430_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;1, hydra::DWave&gt;</a> KST2_1430_Resonance_12(coef_re, coef_im, mass, width,</div><div class="line">                D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;3, hydra::DWave&gt;</a> KST2_1430_Resonance_13(coef_re, coef_im, mass, width,</div><div class="line">                    D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST2_1430_Resonance = (KST2_1430_Resonance_12 + KST2_1430_Resonance_13);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//K*(1680)</span></div><div class="line">    mass    = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;MASS_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_MASS ).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_MASS*0.95,  KST_1680_MASS*1.05 );</div><div class="line">    width   = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;WIDTH_KST_1680&quot;</span>).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_WIDTH).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.0001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_WIDTH*0.95, KST_1680_WIDTH*1.05);</div><div class="line"></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_CRe*0.95,KST_1680_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_KST_1680&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(KST_1680_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(KST_1680_CIm*0.95,KST_1680_CIm*1.05);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;1, hydra::PWave&gt;</a> KST_1680_Resonance_12(coef_re, coef_im, mass, width,</div><div class="line">            D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line">    <a class="code" href="classResonance.html">Resonance&lt;3, hydra::PWave&gt;</a> KST_1680_Resonance_13(coef_re, coef_im, mass, width,</div><div class="line">            D_MASS, K_MASS, PI_MASS, PI_MASS , 5.0);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST_1680_Resonance = (KST_1680_Resonance_12 - KST_1680_Resonance_13);</div><div class="line"></div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//NR</span></div><div class="line">    coef_re = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_RE_NR&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(NR_CRe).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(NR_CRe*0.95,NR_CRe*1.05);</div><div class="line">    coef_im = <a class="code" href="group__fit.html#ab71317b03a67ac0de6daec09c16df4c6">hydra::Parameter::Create</a>().<a class="code" href="group__fit.html#abd604574084c4877e12eb4a429d3a5bf">Name</a>(<span class="stringliteral">&quot;A_IM_NR&quot;</span> ).<a class="code" href="group__fit.html#ab9d71d53dc79d1839971ec8cdced636a">Value</a>(NR_CIm).<a class="code" href="group__fit.html#a49f5d6946e744c41d88678858386c0b1">Error</a>(0.001).<a class="code" href="group__fit.html#affd113cf96daed021e40e90ecd44286e">Limits</a>(NR_CIm*0.95,NR_CIm*1.05);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> NR = <a class="code" href="classNonResonant.html">NonResonant</a>(coef_re, coef_im);</div><div class="line">    <span class="comment">//======================================================</span></div><div class="line">    <span class="comment">//Total: Model |N.R + \sum{ Resonaces }|^2</span></div><div class="line"></div><div class="line">    <span class="comment">//parametric lambda</span></div><div class="line">    <span class="keyword">auto</span> Norm = <a name="a25"></a><a class="code" href="group__functor.html#ga039a5582fbb2830db577f02056555a6d">hydra::wrap_lambda</a>( [] __hydra_dual__ ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>* x){</div><div class="line"></div><div class="line">                <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a> r(0,0);</div><div class="line"></div><div class="line">                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt; n;i++) r += x[i];</div><div class="line"></div><div class="line">                <span class="keywordflow">return</span> <a name="a26"></a><a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>(r);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//model-functor</span></div><div class="line">    <span class="keyword">auto</span> Model = <a name="a27"></a><a class="code" href="namespacehydra.html#a63f3e9bfd1cc2dc4e593ef68f76ba3c6">hydra::compose</a>(Norm,</div><div class="line">            K800_Resonance,</div><div class="line">            KST_892_Resonance,</div><div class="line">            KST0_1430_Resonance,</div><div class="line">            KST2_1430_Resonance,</div><div class="line">            KST_1680_Resonance,</div><div class="line">            NR );</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> B0(D_MASS, 0.0, 0.0, 0.0);</div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi J/psi</span></div><div class="line">    <a name="_a28"></a><a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> phsp{K_MASS, PI_MASS, PI_MASS};</div><div class="line"></div><div class="line">    <span class="comment">// functor to calculate the 2-body masses</span></div><div class="line">    <span class="keyword">auto</span> dalitz_calculator = <a class="code" href="group__functor.html#ga039a5582fbb2830db577f02056555a6d">hydra::wrap_lambda</a>(</div><div class="line">            [] __hydra_dual__ (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a>* p ){</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span>   M2_12 = (p[0]+p[1]).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_13 = (p[0]+p[2]).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_23 = (p[1]+p[2]).mass2();</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a name="a29"></a><a class="code" href="namespacehydra.html#ac70a2baeff9ebf89f64ebd08ebaab2d7">hydra::make_tuple</a>(M2_12, M2_13, M2_23);</div><div class="line">    });</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">    TH3D Dalitz_Flat(&quot;Dalitz_Flat&quot;,</span></div><div class="line"><span class="comment">            &quot;Flat Dalitz;&quot;</span></div><div class="line"><span class="comment">            &quot;M^{2}(K^{-} #pi_{1}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line"><span class="comment">            &quot;M^{2}(K^{-} #pi_{2}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line"><span class="comment">            &quot;M^{2}(#pi_{1}^{+} #pi_{2}^{+}) [GeV^{2}/c^{4}]&quot;,</span></div><div class="line"><span class="comment">            100, pow(K_MASS  + PI_MASS,2), pow(D_MASS - PI_MASS,2),</span></div><div class="line"><span class="comment">            100, pow(K_MASS  + PI_MASS,2), pow(D_MASS - PI_MASS,2),</span></div><div class="line"><span class="comment">            100, pow(PI_MASS + PI_MASS,2), pow(D_MASS -  K_MASS,2));</span></div><div class="line"><span class="comment">*/</span></div><div class="line">    TH3D Dalitz_Resonances(<span class="stringliteral">&quot;Dalitz_Resonances&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Dalitz - Toy Data -;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{1}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{2}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi_{1}^{+} #pi_{2}^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a name="a30"></a><a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line"></div><div class="line">    TH3D Dalitz_Fit(<span class="stringliteral">&quot;Dalitz_Fit&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Dalitz - Fit -;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{1}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi_{2}^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi_{1}^{+} #pi_{2}^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//control plots</span></div><div class="line">    TH2D Normalization(<span class="stringliteral">&quot;normalization&quot;</span>,</div><div class="line">            <span class="stringliteral">&quot;Model PDF Normalization;Norm;Error&quot;</span>,</div><div class="line">            200, 275.0, 305.0,</div><div class="line">            200, 0.58, 0.64);</div><div class="line"></div><div class="line"></div><div class="line">    TH3D  KST800_12_HIST , KST800_13_HIST,  KST892_12_HIST,  KST892_13_HIST,</div><div class="line">          KST1425_12_HIST, KST1425_13_HIST, KST1430_12_HIST, KST1430_13_HIST,</div><div class="line">          KST1680_12_HIST, KST1680_13_HIST, NR_HIST ;</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span>  KST800_12_FF,  KST800_13_FF,  KST892_12_FF,  KST892_13_FF,</div><div class="line">            KST1425_12_FF, KST1425_13_FF, KST1430_12_FF, KST1430_13_FF,</div><div class="line">            KST1680_12_FF, KST1680_13_FF, NR_FF;</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    <a name="_a31"></a><a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, hydra::host::sys_t &gt;</a> toy_data;</div><div class="line"></div><div class="line">    <span class="comment">//toy data production on device</span></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======= 1 - GENERATE TOY-DATA ========&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        <a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a name="a32"></a><a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, Model,  {D_MASS, K_MASS, PI_MASS}, toy_data, nentries, 2*nentries);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a name="a33"></a><a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; elapsed = <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> - start;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| D+ -&gt; K- pi+ pi+&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; toy_data.size()         &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; elapsed.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        std::cout &lt;&lt; std::endl &lt;&lt;<span class="stringliteral">&quot;Toy Dataset size: &quot;</span>&lt;&lt; toy_data.size() &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    }<span class="comment">//toy data production on device</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//plot toy-data</span></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;========= 2 - PLOT TOY-DATA ==========&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt;  std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, hydra::device::sys_t &gt;</a> toy_data_temp(toy_data);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> particles        = toy_data_temp.GetUnweightedDecays();</div><div class="line">        <span class="keyword">auto</span> dalitz_variables = <a name="a34"></a><a class="code" href="namespacehydra.html#a8d210727c4d8b6989542eff5fd3f6319">hydra::make_range</a>( particles.begin(), particles.end(), dalitz_calculator);</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;======= [Daliz variables] { ( MSq_12, MSq_13, MSq_23) } =======&gt;&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i=0; i&lt;10; i++ )</div><div class="line">            std::cout &lt;&lt; dalitz_variables[i] &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//flat dalitz histogram</span></div><div class="line">        <a name="_a35"></a><a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Dalitz{</div><div class="line">            {100,100,100},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">        };</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        Hist_Dalitz.Fill( dalitz_variables.begin(), dalitz_variables.end() );</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; elapsed = <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> - start;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Sparse histogram fill&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; nentries          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; elapsed.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"><span class="preprocessor">#if THRUST_DEVICE_SYSTEM == THRUST_DEVICE_SYSTEM_CUDA</span></div><div class="line"></div><div class="line">        <span class="comment">//if device is cuda, bring the histogram data to the host</span></div><div class="line">        <span class="comment">//to fill the ROOT histogram faster</span></div><div class="line">        {</div><div class="line">            <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::host::sys_t&gt;</a> Hist_Temp(Hist_Dalitz);</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Temp)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">                <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">                Hist_Temp.GetIndexes(bin, bins);</div><div class="line">                Dalitz_Resonances.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">            }</div><div class="line">        }</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Dalitz)</div><div class="line">        {</div><div class="line">            <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">            <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">            Hist_Dalitz.GetIndexes(bin, bins);</div><div class="line">            Dalitz_Resonances.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// fit</span></div><div class="line">    {</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;=============== 3 - FIT ==============&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;======================================&quot;</span> &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt;  std::endl &lt;&lt; std::endl;</div><div class="line">        <span class="comment">//pdf</span></div><div class="line">        <span class="keyword">auto</span> Model_PDF = <a name="a36"></a><a class="code" href="group__fit.html#ga2d468a0d98a74f41479f8ccb95f5533e">hydra::make_pdf</a>( Model,</div><div class="line">                <a name="_a37"></a><a class="code" href="group__phsp.html#classhydra_1_1PhaseSpaceIntegrator">hydra::PhaseSpaceIntegrator&lt;3, hydra::device::sys_t&gt;</a>(D_MASS, {K_MASS, PI_MASS, PI_MASS}, 500000));</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt;<span class="stringliteral">&quot;| Initial PDF Norm: &quot;</span>&lt;&lt; Model_PDF.GetNorm() &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt;   Model_PDF.GetNormError() &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, hydra::device::sys_t &gt;</a> toy_data_temp(toy_data);</div><div class="line">        <span class="keyword">auto</span> particles        = toy_data_temp.GetUnweightedDecays();</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> fcn = <a name="a38"></a><a class="code" href="group__fit.html#ga6ec47177241d6057ab5d2e4ad5fc84a6">hydra::make_loglikehood_fcn</a>(Model_PDF, particles.begin(),</div><div class="line">                particles.end());</div><div class="line"></div><div class="line">        <span class="comment">//print level</span></div><div class="line">        ROOT::Minuit2::MnPrint::SetLevel(3);</div><div class="line">        <a name="a39"></a><a class="code" href="classhydra_1_1Print.html#a03a2522e2192b2509284f25b4b899c7c">hydra::Print::SetLevel</a>(<a name="a40"></a><a class="code" href="namespacehydra.html#aed873b1b84fbec3791e721b22a52d1fea1bf857a06d5b8463494a6fcac6f4ea26">hydra::WARNING</a>);</div><div class="line"></div><div class="line">        <span class="comment">//minimization strategy</span></div><div class="line">        MnStrategy strategy(2);</div><div class="line"></div><div class="line">        <span class="comment">//create Migrad minimizer</span></div><div class="line">        MnMigrad migrad_d(fcn, fcn.GetParameters().GetMnState() ,  strategy);</div><div class="line"></div><div class="line">        <span class="comment">//print parameters before fitting</span></div><div class="line">        std::cout&lt;&lt;fcn.GetParameters().GetMnState()&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//Minimize and profile the time</span></div><div class="line">        <span class="keyword">auto</span> start_d = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        FunctionMinimum minimum_d =  FunctionMinimum( migrad_d(5000,100) );</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> end_d = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; elapsed_d = end_d - start_d;</div><div class="line"></div><div class="line">        <span class="comment">//time</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| [Migrad] Time (ms) =&quot;</span>&lt;&lt; elapsed_d.count() &lt;&lt;std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//print parameters after fitting</span></div><div class="line">        std::cout&lt;&lt;<span class="stringliteral">&quot;minimum: &quot;</span>&lt;&lt;minimum_d&lt;&lt;std::endl;</div><div class="line"></div><div class="line">        nentries = 2000000;</div><div class="line">        <span class="comment">//----------</span></div><div class="line">        <span class="comment">//plot fit</span></div><div class="line">        <span class="comment">//allocate memory to hold the final states particles</span></div><div class="line">        <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, hydra::device::sys_t &gt;</a> fit_data(nentries);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        <span class="comment">//generate the final state particles</span></div><div class="line">        phsp.Generate(B0, fit_data.begin(), fit_data.end());</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        std::chrono::duration&lt;double, std::milli&gt; elapsed = <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> - start;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------- Device (fit data) -----------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| D+ -&gt; K- pi+ pi+&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; nentries          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; elapsed.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        fit_data.Reweight(fcn.GetPDF().GetFunctor());</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> particles_fit        = fit_data.GetUnweightedDecays();</div><div class="line">        <span class="keyword">auto</span> dalitz_variables_fit = <a class="code" href="namespacehydra.html#a8d210727c4d8b6989542eff5fd3f6319">hydra::make_range</a>( particles_fit.begin(), particles_fit.end(), dalitz_calculator);</div><div class="line">        <span class="keyword">auto</span> dalitz_weights_fit   = fit_data.GetWeights();</div><div class="line"></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;======= [Daliz variables - fit] { weight : ( MSq_12, MSq_13, MSq_23) } =======&gt;&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i=0; i&lt;10; i++ )</div><div class="line">            std::cout &lt;&lt; dalitz_weights_fit[i] &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>&lt;&lt; dalitz_variables_fit[i] &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="comment">//model dalitz histogram</span></div><div class="line">        <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Dalitz{</div><div class="line">            {100,100,100},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">            {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">        };</div><div class="line"></div><div class="line">        start = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        Hist_Dalitz.Fill( dalitz_variables_fit.begin(),</div><div class="line">                dalitz_variables_fit.end(), dalitz_weights_fit.begin()  );</div><div class="line"></div><div class="line">        <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> = std::chrono::high_resolution_clock::now();</div><div class="line"></div><div class="line">        elapsed = <a class="code" href="namespacehydra.html#abbb0cd4e50b5ece72164e5a2bb6921ac">end</a> - start;</div><div class="line"></div><div class="line">        <span class="comment">//output</span></div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;----------------- Device ----------------&quot;</span>&lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Sparse histogram fill&quot;</span>                       &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Number of events :&quot;</span>&lt;&lt; nentries          &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;| Time (ms)        :&quot;</span>&lt;&lt; elapsed.count()   &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt; std::endl;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Optimized components</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="keyword">auto</span> Opt_Model = fcn.GetPDF().GetFunctor();</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST800_12 = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a41"></a><a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>).GetFunctor(<a name="a42"></a><a class="code" href="namespacehydra_1_1placeholders.html#ac0d56a89cc015c8579b7933cc78552e7">_0</a>);</div><div class="line">        <span class="keyword">auto</span> KST800_13 = fcn.GetPDF().GetFunctor().GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST892_12 = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a43"></a><a class="code" href="namespacehydra_1_1placeholders.html#adfba0f80c06fadc6694f3f3ad8ed68bc">_2</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#ac0d56a89cc015c8579b7933cc78552e7">_0</a>);</div><div class="line">        <span class="keyword">auto</span> KST892_13 = fcn.GetPDF().GetFunctor().GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#adfba0f80c06fadc6694f3f3ad8ed68bc">_2</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1425_12 = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a44"></a><a class="code" href="namespacehydra_1_1placeholders.html#a09db94b16cc11622963193aaff7d90f1">_3</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#ac0d56a89cc015c8579b7933cc78552e7">_0</a>);</div><div class="line">        <span class="keyword">auto</span> KST1425_13 = fcn.GetPDF().GetFunctor().GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#a09db94b16cc11622963193aaff7d90f1">_3</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1430_12 = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a45"></a><a class="code" href="namespacehydra_1_1placeholders.html#a6288ff68e8fe762e9cad1f9c3eb91854">_4</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#ac0d56a89cc015c8579b7933cc78552e7">_0</a>);</div><div class="line">        <span class="keyword">auto</span> KST1430_13 = fcn.GetPDF().GetFunctor().GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#a6288ff68e8fe762e9cad1f9c3eb91854">_4</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> KST1680_12 = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a46"></a><a class="code" href="namespacehydra_1_1placeholders.html#a1172a5be7d99dea7c49c7e858dd1be6d">_5</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#ac0d56a89cc015c8579b7933cc78552e7">_0</a>);</div><div class="line">        <span class="keyword">auto</span> KST1680_13 = fcn.GetPDF().GetFunctor().GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#a1172a5be7d99dea7c49c7e858dd1be6d">_5</a>).GetFunctor(<a class="code" href="namespacehydra_1_1placeholders.html#aeeeb42f8f504622ab1fbb117da05fcab">_1</a>);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> NR         = fcn.GetPDF().GetFunctor().GetFunctor(<a name="a47"></a><a class="code" href="namespacehydra_1_1placeholders.html#a055c5b6a4cb2ea686a1080903ea068bc">_6</a>);</div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Draw components</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        KST800_12_HIST  =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST800_12 , {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST800_12_HIST&quot;</span>, nentries);</div><div class="line">        KST800_13_HIST  =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST800_13 , {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST800_13_HIST&quot;</span>, nentries);</div><div class="line">        KST892_12_HIST  =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST892_12 , {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST892_12_HIST&quot;</span>, nentries);</div><div class="line">        KST892_13_HIST  =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST892_13 , {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST892_13_HIST&quot;</span>, nentries);</div><div class="line">        KST1425_12_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1425_12, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1425_12_HIST&quot;</span>, nentries);</div><div class="line">        KST1425_13_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1425_13, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1425_13_HIST&quot;</span>, nentries);</div><div class="line">        KST1430_12_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1430_12, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1430_12_HIST&quot;</span>, nentries);</div><div class="line">        KST1430_13_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1430_13, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1430_13_HIST&quot;</span>, nentries);</div><div class="line">        KST1680_12_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1680_12, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1680_12_HIST&quot;</span>, nentries);</div><div class="line">        KST1680_13_HIST =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(KST1680_13, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;KST1680_13_HIST&quot;</span>, nentries);</div><div class="line">        NR_HIST         =   <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>(NR, {D_MASS, K_MASS, PI_MASS}, <span class="stringliteral">&quot;NR_HIST&quot;</span>, nentries);</div><div class="line"></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        <span class="comment">// Fit fractions</span></div><div class="line">        <span class="comment">//==================================</span></div><div class="line">        KST800_12_FF  = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST800_12 , Opt_Model, {D_MASS, K_MASS, PI_MASS},  nentries);</div><div class="line">        KST800_13_FF  = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST800_13 , Opt_Model, {D_MASS, K_MASS, PI_MASS},  nentries);</div><div class="line">        KST892_12_FF  = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST892_12 , Opt_Model, {D_MASS, K_MASS, PI_MASS},  nentries);</div><div class="line">        KST892_13_FF  = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST892_13 , Opt_Model, {D_MASS, K_MASS, PI_MASS},  nentries);</div><div class="line">        KST1425_12_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1425_12 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        KST1425_13_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1425_13 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        KST1430_12_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1430_12 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        KST1430_13_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1430_13 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        KST1680_12_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1680_12 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        KST1680_13_FF = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(KST1680_13 , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line">        NR_FF         = <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>(NR , Opt_Model, {D_MASS, K_MASS, PI_MASS}, nentries);</div><div class="line"></div><div class="line"></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST800_12_FF :&quot;</span> &lt;&lt; KST800_12_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST800_13_FF :&quot;</span> &lt;&lt; KST800_13_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST892_12_FF :&quot;</span> &lt;&lt; KST892_12_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST892_13_FF :&quot;</span> &lt;&lt; KST892_13_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1425_12_FF :&quot;</span> &lt;&lt; KST1425_12_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1425_13_FF :&quot;</span> &lt;&lt; KST1425_13_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1430_12_FF :&quot;</span> &lt;&lt; KST1430_12_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1430_13_FF :&quot;</span> &lt;&lt; KST1430_13_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1680_12_FF :&quot;</span> &lt;&lt; KST1680_12_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;KST1680_13_FF :&quot;</span> &lt;&lt; KST1680_13_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;NR_FF :&quot;</span> &lt;&lt; NR_FF &lt;&lt; std::endl;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Sum :&quot;</span></div><div class="line">                  &lt;&lt; KST800_12_FF  + KST800_13_FF  +</div><div class="line">                     KST892_12_FF  + KST892_13_FF  + KST1425_12_FF +</div><div class="line">                     KST1425_13_FF + KST1430_12_FF + KST1430_13_FF +</div><div class="line">                     KST1680_12_FF + KST1680_13_FF + NR_FF &lt;&lt; std::endl;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line">        {</div><div class="line">            std::vector&lt;double&gt; integrals;</div><div class="line">            std::vector&lt;double&gt; integrals_error;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> x: fcn.GetPDF().GetNormCache() ){</div><div class="line">                integrals.push_back(x.second.first);</div><div class="line">                integrals_error.push_back(x.second.second);</div><div class="line"></div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keyword">auto</span> integral_bounds = std::minmax_element(integrals.begin(),</div><div class="line">                    integrals.end());</div><div class="line"></div><div class="line">            <span class="keyword">auto</span>  integral_error_bounds = std::minmax_element(integrals_error.begin(),</div><div class="line">                    integrals_error.end());</div><div class="line"></div><div class="line">            Normalization.GetXaxis()-&gt;SetLimits(*integral_bounds.first, *integral_bounds.second);</div><div class="line">            Normalization.GetYaxis()-&gt;SetLimits(*integral_error_bounds.first, *integral_error_bounds.second);</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> x: fcn.GetPDF().GetNormCache() ){</div><div class="line"></div><div class="line">                Normalization.Fill(x.second.first, x.second.second );</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#if THRUST_DEVICE_SYSTEM == THRUST_DEVICE_SYSTEM_CUDA</span></div><div class="line"></div><div class="line">        <span class="comment">//if device is cuda, bring the histogram data to the host</span></div><div class="line">        <span class="comment">//to fill the ROOT histogram faster</span></div><div class="line">        {</div><div class="line">            <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::host::sys_t&gt;</a> Hist_Temp(Hist_Dalitz);</div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">            <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Temp)</div><div class="line">            {</div><div class="line">                <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">                <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">                Hist_Temp.GetIndexes(bin, bins);</div><div class="line">                Dalitz_Fit.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">            }</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Filling a ROOT Histogram... &quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Dalitz)</div><div class="line">        {</div><div class="line">            <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">            <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">            Hist_Dalitz.GetIndexes(bin, bins);</div><div class="line">            Dalitz_Fit.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">        }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef  _ROOT_AVAILABLE_</span></div><div class="line"></div><div class="line"></div><div class="line">    TApplication *m_app=<span class="keyword">new</span> TApplication(<span class="stringliteral">&quot;myapp&quot;</span>,0,0);</div><div class="line"></div><div class="line"></div><div class="line">    Dalitz_Fit.Scale(Dalitz_Resonances.Integral()/Dalitz_Fit.Integral() );</div><div class="line"></div><div class="line">    KST800_12_HIST.Scale( KST800_12_FF*Dalitz_Fit.Integral()/KST800_12_HIST.Integral() );</div><div class="line">    KST800_13_HIST.Scale( KST800_13_FF*Dalitz_Fit.Integral()/KST800_13_HIST.Integral() );</div><div class="line"></div><div class="line">    KST892_12_HIST.Scale( KST892_12_FF*Dalitz_Fit.Integral()/KST892_12_HIST.Integral() );</div><div class="line">    KST892_13_HIST.Scale( KST892_13_FF*Dalitz_Fit.Integral()/KST892_13_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1425_12_HIST.Scale( KST1425_12_FF*Dalitz_Fit.Integral()/KST1425_12_HIST.Integral() );</div><div class="line">    KST1425_13_HIST.Scale( KST1425_13_FF*Dalitz_Fit.Integral()/KST1425_13_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1430_12_HIST.Scale( KST1430_12_FF*Dalitz_Fit.Integral()/KST1430_12_HIST.Integral() );</div><div class="line">    KST1430_13_HIST.Scale( KST1430_13_FF*Dalitz_Fit.Integral()/KST1430_13_HIST.Integral() );</div><div class="line"></div><div class="line">    KST1680_12_HIST.Scale( KST1680_12_FF*Dalitz_Fit.Integral()/KST1680_12_HIST.Integral() );</div><div class="line">    KST1680_13_HIST.Scale( KST1680_13_FF*Dalitz_Fit.Integral()/KST1680_13_HIST.Integral() );</div><div class="line"></div><div class="line">    NR_HIST.Scale( NR_FF*Dalitz_Fit.Integral()/NR_HIST.Integral() );</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line">    <span class="comment">//projections</span></div><div class="line">    TH1* hist2D=0;</div><div class="line"></div><div class="line">    TCanvas canvas_3(<span class="stringliteral">&quot;canvas_3&quot;</span>, <span class="stringliteral">&quot;Dataset&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Resonances.Project3D(<span class="stringliteral">&quot;yz&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_3.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Dataset1.pdf&quot;</span>);</div><div class="line"></div><div class="line">    TCanvas canvas_4(<span class="stringliteral">&quot;canvas_4&quot;</span>, <span class="stringliteral">&quot;Dataset&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Resonances.Project3D(<span class="stringliteral">&quot;xy&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_4.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Dataset2.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    TCanvas canvas_5(<span class="stringliteral">&quot;canvas_5&quot;</span>, <span class="stringliteral">&quot;Fit&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Fit.Project3D(<span class="stringliteral">&quot;yz&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;SetStats(0);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_5.SaveAs(<span class="stringliteral">&quot;plots/dalitz/FitResult1.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    TCanvas canvas_6(<span class="stringliteral">&quot;canvas_4&quot;</span>, <span class="stringliteral">&quot;Phase-space FLAT&quot;</span>, 500, 500);</div><div class="line">    hist2D = Dalitz_Fit.Project3D(<span class="stringliteral">&quot;xy&quot;</span>);</div><div class="line">    hist2D-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    hist2D-&gt;SetStats(0);</div><div class="line">    hist2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line">    canvas_6.SaveAs(<span class="stringliteral">&quot;plots/dalitz/FitResult2.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line">    <span class="comment">//projections</span></div><div class="line">    TH1* hist=0;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* axis =0;</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> KST800_Color  = kViolet-5;</div><div class="line">    <span class="keyword">auto</span> KST892_Color  = kBlue;</div><div class="line">    <span class="keyword">auto</span> KST1425_Color = kGreen-2;</div><div class="line">    <span class="keyword">auto</span> KST1430_Color = kOrange-3;</div><div class="line">    <span class="keyword">auto</span> KST1680_Color = kYellow-2;</div><div class="line">    <span class="keyword">auto</span> NR_Color      = kBlack;</div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> X1NDC = 0.262458;</div><div class="line">    <span class="keywordtype">double</span> Y1NDC = 0.127544;</div><div class="line">    <span class="keywordtype">double</span> X2NDC = 0.687708;</div><div class="line">    <span class="keywordtype">double</span> Y2NDC = 0.35;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//==============================</span></div><div class="line">    axis = <span class="stringliteral">&quot;x&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_x(<span class="stringliteral">&quot;canvas_x&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_x = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_x.SetEntrySeparation(0.3);</div><div class="line">    legend_x.SetNColumns(2);</div><div class="line">    legend_x.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST892_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST892_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1680_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1680_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_x.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_x.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_X.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_x.SetLogy(1);</div><div class="line"></div><div class="line">    legend_x.Draw();</div><div class="line"></div><div class="line">    canvas_x.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogX.pdf&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line">    axis = <span class="stringliteral">&quot;y&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_y(<span class="stringliteral">&quot;canvas_y&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_y = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_y.SetEntrySeparation(0.3);</div><div class="line">    legend_y.SetNColumns(2);</div><div class="line">    legend_y.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST892_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST892_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1680_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1680_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_y.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_y.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_Y.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_y.SetLogy(1);</div><div class="line"></div><div class="line">    legend_y.Draw();</div><div class="line"></div><div class="line">    canvas_y.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogY.pdf&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    axis = <span class="stringliteral">&quot;z&quot;</span>;</div><div class="line"></div><div class="line">    TCanvas canvas_z(<span class="stringliteral">&quot;canvas_z&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 600, 750);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> legend_z = TLegend( X1NDC, Y1NDC, X2NDC, Y2NDC);</div><div class="line">    <span class="comment">//legend.SetHeader(&quot;M^{2}(K^{-} #pi_{1}^{+})&quot;,&quot;C&quot;); // option &quot;C&quot; allows to center the header</span></div><div class="line">    legend_z.SetEntrySeparation(0.3);</div><div class="line">    legend_z.SetNColumns(2);</div><div class="line">    legend_z.SetBorderSize(0);</div><div class="line"></div><div class="line">    hist= Dalitz_Fit.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;hist&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line">    hist-&gt;SetMinimum(0.001);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line">    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;Fit&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist= Dalitz_Resonances.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;e0same&quot;</span>);</div><div class="line">    hist-&gt;SetMarkerStyle(8);</div><div class="line">    hist-&gt;SetMarkerSize(0.6);</div><div class="line">    hist-&gt;SetStats(0);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;Data&quot;</span>,<span class="stringliteral">&quot;lep&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST800_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST800_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{#kappa}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST892_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST892_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST892_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*(892)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    hist = KST1680_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1680_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1680_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K_{1}(1680)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1425_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineColor(KST1425_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*_{0}(1425)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_12_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{12}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = KST1430_13_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(KST1430_Color);</div><div class="line">    hist-&gt;SetLineStyle(2);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;{K*_{2}(1430)}_{13}&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    hist = NR_HIST.Project3D(axis)-&gt;DrawCopy(<span class="stringliteral">&quot;histCsame&quot;</span>);</div><div class="line">    hist-&gt;SetLineColor(NR_Color);</div><div class="line">    hist-&gt;SetLineStyle(5);</div><div class="line">    hist-&gt;SetLineWidth(2);</div><div class="line"></div><div class="line">    legend_z.AddEntry(hist,<span class="stringliteral">&quot;NR&quot;</span>,<span class="stringliteral">&quot;l&quot;</span>);</div><div class="line"></div><div class="line">    canvas_z.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_Z.pdf&quot;</span>);</div><div class="line"></div><div class="line">    canvas_z.SetLogy(1);</div><div class="line"></div><div class="line">    legend_z.Draw();</div><div class="line"></div><div class="line">    canvas_z.SaveAs(<span class="stringliteral">&quot;plots/dalitz/Proj_LogZ.pdf&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">//=============================================================</span></div><div class="line"></div><div class="line">    TCanvas canvas_7(<span class="stringliteral">&quot;canvas_7&quot;</span>, <span class="stringliteral">&quot;Normalization&quot;</span>, 500, 500);</div><div class="line">    Normalization.Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    m_app-&gt;Run();</div><div class="line"></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Backend, <span class="keyword">typename</span> Model, <span class="keyword">typename</span> Container &gt;</div><div class="line"><span class="keywordtype">size_t</span> <a class="code" href="dalitz__plot_8inl.html#a4a9b2506fea91219d7e88d2053cc1ace">generate_dataset</a>(<a class="code" href="namespacehydra_1_1detail.html#a1461b18b118ced9f91233acbe90fd897">Backend</a> <span class="keyword">const</span>&amp; system, Model <span class="keyword">const</span>&amp; model, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, Container&amp; decays, <span class="keywordtype">size_t</span> nevents, <span class="keywordtype">size_t</span> bunch_size)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = masses[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = masses[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = masses[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> D(D_MASS, 0.0, 0.0, 0.0);</div><div class="line"></div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> phsp{K_MASS, PI_MASS, PI_MASS};</div><div class="line"></div><div class="line">    <span class="comment">//allocate memory to hold the final states particles</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, Backend &gt;</a> _data(bunch_size);</div><div class="line"></div><div class="line">    std::srand(7531594562);</div><div class="line"></div><div class="line">    <span class="keywordflow">do</span> {</div><div class="line">        phsp.SetSeed(std::rand());</div><div class="line"></div><div class="line">        <span class="comment">//generate the final state particles</span></div><div class="line">        phsp.Generate(D, _data.begin(), _data.end());</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> last = _data.Unweight(model, 1.0);</div><div class="line"></div><div class="line">        decays.insert(decays.size()==0? decays.begin():decays.end(),</div><div class="line">                _data.begin(), _data.begin()+last );</div><div class="line"></div><div class="line">    } <span class="keywordflow">while</span>(decays.size()&lt;nevents );</div><div class="line"></div><div class="line">    decays.erase(decays.begin()+nevents, decays.end());</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> decays.size();</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude, <span class="keyword">typename</span> Model&gt;</div><div class="line"><span class="keywordtype">double</span> <a class="code" href="dalitz__plot_8inl.html#a7557de3188af6904d9807280b50220ea">fit_fraction</a>( Amplitude <span class="keyword">const</span>&amp; amp, Model <span class="keyword">const</span>&amp; model, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, <span class="keywordtype">size_t</span> nentries)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = masses[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = masses[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = masses[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> D(D_MASS, 0.0, 0.0, 0.0);</div><div class="line"></div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> phsp{K_MASS, PI_MASS, PI_MASS};</div><div class="line"></div><div class="line">    <span class="comment">//norm lambda</span></div><div class="line">    <span class="keyword">auto</span> Norm = <a class="code" href="group__functor.html#ga039a5582fbb2830db577f02056555a6d">hydra::wrap_lambda</a>( [] __hydra_dual__ (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>* x){</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>(x[0]);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//functor</span></div><div class="line">    <span class="keyword">auto</span> functor = <a class="code" href="namespacehydra.html#a63f3e9bfd1cc2dc4e593ef68f76ba3c6">hydra::compose</a>(Norm, amp);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> amp_int   = phsp.AverageOn(<a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, D, functor, nentries);</div><div class="line">    <span class="keyword">auto</span> model_int = phsp.AverageOn(<a class="code" href="namespacehydra_1_1device.html#a341761b36a1162bbd0e852a81a98823e">hydra::device::sys</a>, D, model,   nentries);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> amp_int.first/model_int.first;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Amplitude&gt;</div><div class="line">TH3D <a class="code" href="dalitz__plot_8inl.html#a2bdb6a5a65d1bbaf33f08dd544a478cf">histogram_component</a>( Amplitude <span class="keyword">const</span>&amp; amp, std::array&lt;double, 3&gt; <span class="keyword">const</span>&amp; masses, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> nentries)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> D_MASS         = masses[0];<span class="comment">// D+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> K_MASS         = masses[1];<span class="comment">// K+ mass</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> PI_MASS        = masses[2];<span class="comment">// pi mass</span></div><div class="line"></div><div class="line">    TH3D Component(name,</div><div class="line">            <span class="stringliteral">&quot;;&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(K^{-} #pi^{+}) [GeV^{2}/c^{4}];&quot;</span></div><div class="line">            <span class="stringliteral">&quot;M^{2}(#pi^{+} #pi^{+}) [GeV^{2}/c^{4}]&quot;</span>,</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS  + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2),</div><div class="line">            100, <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS -  K_MASS,2));</div><div class="line"></div><div class="line">    <span class="comment">//--------------------</span></div><div class="line">    <span class="comment">//generator</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a> D(D_MASS, 0.0, 0.0, 0.0);</div><div class="line">    <span class="comment">// Create PhaseSpace object for B0-&gt; K pi pi</span></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1PhaseSpace">hydra::PhaseSpace&lt;3&gt;</a> phsp{K_MASS, PI_MASS, PI_MASS};</div><div class="line"></div><div class="line">    <span class="comment">// functor to calculate the 2-body masses</span></div><div class="line">    <span class="keyword">auto</span> dalitz_calculator = <a class="code" href="group__functor.html#ga039a5582fbb2830db577f02056555a6d">hydra::wrap_lambda</a>(</div><div class="line">            [] __hydra_dual__ (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="group__phsp.html#classhydra_1_1Vector4R">hydra::Vector4R</a>* p ){</div><div class="line"></div><div class="line">        <span class="keywordtype">double</span>   M2_12 = (p[0]+p[1]).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_13 = (p[0]+p[2]).mass2();</div><div class="line">        <span class="keywordtype">double</span>   M2_23 = (p[1]+p[2]).mass2();</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ac70a2baeff9ebf89f64ebd08ebaab2d7">hydra::make_tuple</a>(M2_12, M2_13, M2_23);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//norm lambda</span></div><div class="line">    <span class="keyword">auto</span> Norm = <a class="code" href="group__functor.html#ga039a5582fbb2830db577f02056555a6d">hydra::wrap_lambda</a>(</div><div class="line">            [] __hydra_dual__ (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n, <a class="code" href="namespacehydra.html#a4f9af1aefe36fa4f80f57289ffb84dca">hydra::complex&lt;double&gt;</a>* x){</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="namespacehydra.html#ab5fd2d8f62c3075ccdd36241e8dc6881">hydra::norm</a>(x[0]);</div><div class="line">    });</div><div class="line"></div><div class="line">    <span class="comment">//functor</span></div><div class="line">    <span class="keyword">auto</span> functor = <a class="code" href="namespacehydra.html#a63f3e9bfd1cc2dc4e593ef68f76ba3c6">hydra::compose</a>(Norm, amp);</div><div class="line"></div><div class="line">    <a class="code" href="group__phsp.html#classhydra_1_1Decays">hydra::Decays&lt;3, hydra::device::sys_t &gt;</a> events(nentries);</div><div class="line"></div><div class="line">    phsp.Generate(D, events.begin(), events.end());</div><div class="line"></div><div class="line">    events.Reweight(functor);</div><div class="line"></div><div class="line">    <span class="keyword">auto</span> particles        = events.GetUnweightedDecays();</div><div class="line">    <span class="keyword">auto</span> dalitz_variables = <a class="code" href="namespacehydra.html#a8d210727c4d8b6989542eff5fd3f6319">hydra::make_range</a>( particles.begin(), particles.end(), dalitz_calculator);</div><div class="line">    <span class="keyword">auto</span> dalitz_weights   = events.GetWeights();</div><div class="line"></div><div class="line">    <span class="comment">//model dalitz histogram</span></div><div class="line">    <a class="code" href="group__histogram.html#classhydra_1_1SparseHistogram">hydra::SparseHistogram&lt;double, 3,  hydra::device::sys_t&gt;</a> Hist_Component{</div><div class="line">        {100,100,100},</div><div class="line">        {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(K_MASS + PI_MASS,2),  <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(PI_MASS + PI_MASS,2)},</div><div class="line">        {<a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - PI_MASS ,2), <a class="code" href="namespacehydra.html#ac2256bff965f5a7359591579a97114ec">pow</a>(D_MASS - K_MASS,2)}</div><div class="line">    };</div><div class="line"></div><div class="line">    Hist_Component.Fill( dalitz_variables.begin(),</div><div class="line">                    dalitz_variables.end(), dalitz_weights.begin()  );</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : Hist_Component){</div><div class="line"></div><div class="line">        <span class="keywordtype">size_t</span> bin     = hydra::get&lt;0&gt;(entry);</div><div class="line">        <span class="keywordtype">double</span> content = hydra::get&lt;1&gt;(entry);</div><div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bins[3];</div><div class="line">        Hist_Component.GetIndexes(bin, bins);</div><div class="line">        Component.SetBinContent(bins[0]+1, bins[1]+1, bins[2]+1, content);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> Component;</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#endif </span><span class="comment">/* DALITZ_PLOT_INL_ */</span><span class="preprocessor"></span></div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Mar 23 2018 14:51:40 for Hydra by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
